{"ast":null,"code":"import{useState,useEffect,useRef}from'react';import{useAuth}from'../context/AuthContext';import{useParams,useNavigate}from'react-router-dom';import axios from'axios';import'leaflet/dist/leaflet.css';import'../css/AjouterRapport.css';// Utilisation du m√™me fichier CSS pour la coh√©rence visuelle\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=process.env.REACT_APP_API_URL;const ModifierRapport=()=>{const{id}=useParams();// r√©cup√®re l'id depuis l'URL\nconst navigate=useNavigate();const{authData}=useAuth();const[hasAccess,setHasAccess]=useState(false);const[accessChecked,setAccessChecked]=useState(false);useEffect(()=>{const checkAccess=async()=>{try{const accesResponse=await axios.get(`${API}/rapports/${id}/acces`);const accesList=accesResponse.data;const rapportResponse=await axios.get(`${API}/rapports/${id}`);const rapport=rapportResponse.data.rapport||rapportResponse.data;const estCreateur=rapport.id_operateur===authData.Opid;const aAccess=accesList.some(acc=>acc.id_operateur===authData.Opid);setHasAccess(estCreateur||aAccess);if(estCreateur||aAccess){setHasAccess(true);}else{setHasAccess(false);}}catch(error){console.error('Erreur lors de la v√©rification de l\\'acc√®s :',error);setHasAccess(false);}finally{setAccessChecked(true);}};checkAccess();},[authData,id]);const[isSubmitting,setIsSubmitting]=useState(false);const[submitStatus,setSubmitStatus]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const mapRef=useRef(null);const leafletMapRef=useRef(null);const[mapInitialized,setMapInitialized]=useState(false);const[marker,setMarker]=useState(null);// √âtats pour les listes d√©roulantes\nconst[typesEvenement,setTypesEvenement]=useState([]);const[sousTypesEvenement,setSousTypesEvenement]=useState([]);const[originesEvenement,setOriginesEvenement]=useState([]);const[typesCibleRes,setTypesCible]=useState([]);const[zonesGeographiques,setZonesGeographiques]=useState([]);const[filteredSousTypes,setFilteredSousTypes]=useState([]);const initialFormData={titre:'',date_evenement:'',heure_evenement:'',description_globale:'',id_type_evenement:'',id_sous_type_evenement:'',id_origine_evenement:'',id_cible:'',nom_cible:'',pavillon_cible:'',libelle:'',immatriculation:'',TypeProduit:'',QuantiteProduit:'',id_zone:'',details_lieu:'',latitude:'',longitude:'',direction_vent:'',force_vent:'',etat_mer:'',nebulosite:'',maree:'',cedre_alerte:false,cross_alerte:false,photo:false,message_polrep:false,derive_mothy:false,polmar_terre:false,smp:false,bsaa:false,sensible_proximite:false,moyen_proximite:'',moyen_depeche:'',moyen_marine_etat:'',risque_court_terme:'',risque_moyen_long_terme:'',delai_appareillage:''};const[formData,setFormData]=useState(initialFormData);const[ancienRapport,setAncienRapport]=useState(initialFormData);// Chargement des donn√©es du rapport et des listes d√©roulantes\nuseEffect(()=>{const fetchData=async()=>{console.log('üì• D√©but du chargement des donn√©es du rapport et des listes d√©roulantes...');try{var _rapportData$id_type_,_rapportData$id_sous_,_rapportData$id_origi,_metaData$cible,_metaData$cible$id_ty,_metaData$cible2,_metaData$cible3,_metaData$typeCible,_metaData$cible4,_metaData$cible5,_metaData$cible6,_metaData$localisatio,_metaData$localisatio2,_metaData$localisatio3,_metaData$localisatio4,_metaData$localisatio5,_metaData$localisatio6,_metaData$localisatio7,_metaData$meteo,_metaData$meteo2,_metaData$meteo2$forc,_metaData$meteo3,_metaData$meteo3$etat,_metaData$meteo4,_metaData$meteo4$nebu,_metaData$meteo5,_metaData$alertes,_metaData$alertes2,_metaData$alertes3,_metaData$alertes4,_metaData$alertes5,_metaData$alertes6,_metaData$alertes7,_metaData$alertes8,_metaData$alertes9,_metaData$alertes10,_metaData$alertes11,_metaData$alertes12,_metaData$alertes13,_metaData$alertes14,_metaData$alertes15;setLoading(true);setError('');console.log('üîÑ Requ√™tes en cours vers l\\'API...');const[typesRes,sousTypesRes,originesRes,zonesRes,typesCibleRes,rapportRes]=await Promise.all([axios.get(`${API}/rapports/type-evenement`),axios.get(`${API}/rapports/sous-type-pollution`),axios.get(`${API}/rapports/origine-evenement`),axios.get(`${API}/rapports/zone-geographique`),axios.get(`${API}/rapports/type-cible`),axios.get(`${API}/rapports/${id}`)]);console.log('‚úÖ Donn√©es des listes d√©roulantes r√©cup√©r√©es avec succ√®s.');// Mise √† jour des listes\nsetTypesEvenement(typesRes.data);setSousTypesEvenement(sousTypesRes.data);setOriginesEvenement(originesRes.data);setZonesGeographiques(zonesRes.data);setTypesCible(typesCibleRes.data);console.log('üì¶ R√©cup√©ration et traitement des donn√©es du rapport...');const rapportData=rapportRes.data.rapport||rapportRes.data;const metaData=rapportRes.data.metaData||{};// üßæ Affichage brut des donn√©es r√©cup√©r√©es\nconsole.log('üìÑ Donn√©es du rapport r√©cup√©r√©es :',rapportData);console.log('üìÑ MetaData associ√©es :',metaData);// Formatage date/heure locale\nlet dateEvenement='';let heureEvenement='';if(rapportData.date_evenement){const dateObj=new Date(rapportData.date_evenement);dateEvenement=dateObj.toISOString().split('T')[0];heureEvenement=dateObj.toTimeString().substring(0,5);console.log(`üïí Date UTC re√ßue : ${rapportData.date_evenement} ‚Üí affich√©e : ${dateEvenement} ${heureEvenement}`);}const newFormData={titre:rapportData.titre||'',date_evenement:dateEvenement,heure_evenement:heureEvenement,description_globale:rapportData.description_globale||'',id_type_evenement:((_rapportData$id_type_=rapportData.id_type_evenement)===null||_rapportData$id_type_===void 0?void 0:_rapportData$id_type_.toString())||'',id_sous_type_evenement:((_rapportData$id_sous_=rapportData.id_sous_type_evenement)===null||_rapportData$id_sous_===void 0?void 0:_rapportData$id_sous_.toString())||'',id_origine_evenement:((_rapportData$id_origi=rapportData.id_origine_evenement)===null||_rapportData$id_origi===void 0?void 0:_rapportData$id_origi.toString())||'',id_cible:((_metaData$cible=metaData.cible)===null||_metaData$cible===void 0?void 0:(_metaData$cible$id_ty=_metaData$cible.id_type_cible)===null||_metaData$cible$id_ty===void 0?void 0:_metaData$cible$id_ty.toString())||'',nom_cible:((_metaData$cible2=metaData.cible)===null||_metaData$cible2===void 0?void 0:_metaData$cible2.nom)||'',pavillon_cible:((_metaData$cible3=metaData.cible)===null||_metaData$cible3===void 0?void 0:_metaData$cible3.pavillon)||'',libelle:((_metaData$typeCible=metaData.typeCible)===null||_metaData$typeCible===void 0?void 0:_metaData$typeCible.libelle)||'',immatriculation:((_metaData$cible4=metaData.cible)===null||_metaData$cible4===void 0?void 0:_metaData$cible4.immatriculation)||'',TypeProduit:((_metaData$cible5=metaData.cible)===null||_metaData$cible5===void 0?void 0:_metaData$cible5.TypeProduit)||'',QuantiteProduit:((_metaData$cible6=metaData.cible)===null||_metaData$cible6===void 0?void 0:_metaData$cible6.QuantiteProduit)||'',id_zone:((_metaData$localisatio=metaData.localisation)===null||_metaData$localisatio===void 0?void 0:(_metaData$localisatio2=_metaData$localisatio.id_zone)===null||_metaData$localisatio2===void 0?void 0:_metaData$localisatio2.toString())||'',details_lieu:((_metaData$localisatio3=metaData.localisation)===null||_metaData$localisatio3===void 0?void 0:_metaData$localisatio3.details_lieu)||'',latitude:((_metaData$localisatio4=metaData.localisation)===null||_metaData$localisatio4===void 0?void 0:(_metaData$localisatio5=_metaData$localisatio4.latitude)===null||_metaData$localisatio5===void 0?void 0:_metaData$localisatio5.toString())||'',longitude:((_metaData$localisatio6=metaData.localisation)===null||_metaData$localisatio6===void 0?void 0:(_metaData$localisatio7=_metaData$localisatio6.longitude)===null||_metaData$localisatio7===void 0?void 0:_metaData$localisatio7.toString())||'',direction_vent:((_metaData$meteo=metaData.meteo)===null||_metaData$meteo===void 0?void 0:_metaData$meteo.direction_vent)||'',force_vent:((_metaData$meteo2=metaData.meteo)===null||_metaData$meteo2===void 0?void 0:(_metaData$meteo2$forc=_metaData$meteo2.force_vent)===null||_metaData$meteo2$forc===void 0?void 0:_metaData$meteo2$forc.toString())||'',etat_mer:((_metaData$meteo3=metaData.meteo)===null||_metaData$meteo3===void 0?void 0:(_metaData$meteo3$etat=_metaData$meteo3.etat_mer)===null||_metaData$meteo3$etat===void 0?void 0:_metaData$meteo3$etat.toString())||'',nebulosite:((_metaData$meteo4=metaData.meteo)===null||_metaData$meteo4===void 0?void 0:(_metaData$meteo4$nebu=_metaData$meteo4.nebulosite)===null||_metaData$meteo4$nebu===void 0?void 0:_metaData$meteo4$nebu.toString())||'',maree:((_metaData$meteo5=metaData.meteo)===null||_metaData$meteo5===void 0?void 0:_metaData$meteo5.maree)||'',cedre_alerte:((_metaData$alertes=metaData.alertes)===null||_metaData$alertes===void 0?void 0:_metaData$alertes.cedre)===1,cross_alerte:((_metaData$alertes2=metaData.alertes)===null||_metaData$alertes2===void 0?void 0:_metaData$alertes2.cross_contact)===1,photo:((_metaData$alertes3=metaData.alertes)===null||_metaData$alertes3===void 0?void 0:_metaData$alertes3.photo)===1,message_polrep:((_metaData$alertes4=metaData.alertes)===null||_metaData$alertes4===void 0?void 0:_metaData$alertes4.polrep)===1,derive_mothy:((_metaData$alertes5=metaData.alertes)===null||_metaData$alertes5===void 0?void 0:_metaData$alertes5.derive_mothy)===1,polmar_terre:((_metaData$alertes6=metaData.alertes)===null||_metaData$alertes6===void 0?void 0:_metaData$alertes6.pne)===1,smp:((_metaData$alertes7=metaData.alertes)===null||_metaData$alertes7===void 0?void 0:_metaData$alertes7.smp)===1,bsaa:((_metaData$alertes8=metaData.alertes)===null||_metaData$alertes8===void 0?void 0:_metaData$alertes8.bsaa)===1,sensible_proximite:((_metaData$alertes9=metaData.alertes)===null||_metaData$alertes9===void 0?void 0:_metaData$alertes9.sensible_proximite)===1,moyen_proximite:((_metaData$alertes10=metaData.alertes)===null||_metaData$alertes10===void 0?void 0:_metaData$alertes10.moyen_proximite)||'',moyen_depeche:((_metaData$alertes11=metaData.alertes)===null||_metaData$alertes11===void 0?void 0:_metaData$alertes11.moyen_depeche)||'',moyen_marine_etat:((_metaData$alertes12=metaData.alertes)===null||_metaData$alertes12===void 0?void 0:_metaData$alertes12.moyen_marine_etat)||'',risque_court_terme:((_metaData$alertes13=metaData.alertes)===null||_metaData$alertes13===void 0?void 0:_metaData$alertes13.risque_court_terme)||'',risque_moyen_long_terme:((_metaData$alertes14=metaData.alertes)===null||_metaData$alertes14===void 0?void 0:_metaData$alertes14.risque_moyen_long_terme)||'',delai_appareillage:((_metaData$alertes15=metaData.alertes)===null||_metaData$alertes15===void 0?void 0:_metaData$alertes15.delai_appareillage_bsaa)||''};console.log('üìù Formulaire pr√©rempli avec :',newFormData);setFormData(newFormData);setAncienRapport(newFormData);}catch(err){console.error('‚ùå Erreur lors du chargement des donn√©es :',err);setError('Impossible de charger les donn√©es du rapport.');}finally{setLoading(false);console.log('‚úÖ Chargement termin√©.');}};fetchData();},[id]);// Supprimez le premier useEffect qui fait juste appel √† chargerRapport()\n// Filtrer les sous-types en fonction du type s√©lectionn√©\nuseEffect(()=>{if(formData.id_type_evenement){const filtered=sousTypesEvenement.filter(sousType=>sousType.id_type_evenement===parseInt(formData.id_type_evenement));setFilteredSousTypes(filtered);}else{setFilteredSousTypes([]);}},[formData.id_type_evenement,sousTypesEvenement]);// Initialisation de la carte Leaflet\nuseEffect(()=>{// S'assurer que la carte est initialis√©e une seule fois et correctement\nif(mapRef.current&&!mapInitialized&&typeof window!=='undefined'&&formData.latitude&&formData.longitude){// S'assurer que Leaflet est disponible\nif(!window.L){const script=document.createElement('script');script.src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';script.integrity='sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=';script.crossOrigin='';// Ajouter la feuille de style Leaflet si elle n'est pas d√©j√† pr√©sente\nif(!document.querySelector('link[href*=\"leaflet.css\"]')){const link=document.createElement('link');link.rel='stylesheet';link.href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';link.integrity='sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=';link.crossOrigin='';document.head.appendChild(link);}script.onload=initMap;document.head.appendChild(script);}else{initMap();}}function initMap(){try{console.log(\"üó∫Ô∏è Initialisation de la carte...\");// Nettoyer la carte pr√©c√©dente si elle existe\nif(leafletMapRef.current){leafletMapRef.current.remove();}// Position initiale bas√©e sur les coordonn√©es du rapport si disponibles\nconst initialPosition=[parseFloat(formData.latitude),parseFloat(formData.longitude)];// Cr√©er la nouvelle carte\nleafletMapRef.current=window.L.map(mapRef.current).setView(initialPosition,10);// Ajouter la couche de tuiles OpenStreetMap\nwindow.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'}).addTo(leafletMapRef.current);// Ajouter un marqueur √† la position initiale si des coordonn√©es sont disponibles\nif(formData.latitude&&formData.longitude){const newMarker=window.L.marker(initialPosition).addTo(leafletMapRef.current);setMarker(newMarker);}// Ajouter un gestionnaire de clic sur la carte\nleafletMapRef.current.on('click',function(e){const{lat,lng}=e.latlng;// Mettre √† jour les champs de latitude et longitude dans le formulaire\nsetFormData(prev=>({...prev,latitude:lat.toFixed(6),longitude:lng.toFixed(6)}));// Mettre √† jour ou cr√©er le marqueur\nif(marker){marker.setLatLng([lat,lng]);}else{const newMarker=window.L.marker([lat,lng]).addTo(leafletMapRef.current);setMarker(newMarker);}console.log(`Position s√©lectionn√©e: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);});// Force la mise √† jour de la carte apr√®s l'initialisation\nsetTimeout(()=>{if(leafletMapRef.current){leafletMapRef.current.invalidateSize();}},200);setMapInitialized(true);console.log(\"‚úÖ Carte initialis√©e avec succ√®s\");}catch(error){console.error('Erreur lors de l\\'initialisation de la carte:',error);}}// Nettoyer la carte au d√©montage du composant\nreturn()=>{if(leafletMapRef.current){leafletMapRef.current.remove();leafletMapRef.current=null;}};},[formData.latitude,formData.longitude]);// G√©rer les changements dans le formulaire\nconst handleChange=e=>{const{name,value,type,checked}=e.target;const newValue=type==='checkbox'?checked:value;setFormData(prev=>({...prev,[name]:newValue}));};// Mettre √† jour la carte si les coordonn√©es sont modifi√©es manuellement\nuseEffect(()=>{if(mapInitialized&&leafletMapRef.current&&formData.latitude&&formData.longitude){const lat=parseFloat(formData.latitude);const lng=parseFloat(formData.longitude);if(!isNaN(lat)&&!isNaN(lng)){// Centrer la carte sur les coordonn√©es saisies manuellement\nleafletMapRef.current.setView([lat,lng],12);// Mettre √† jour ou cr√©er le marqueur\nif(marker){marker.setLatLng([lat,lng]);}else{const newMarker=window.L.marker([lat,lng]).addTo(leafletMapRef.current);setMarker(newMarker);}}}},[formData.latitude,formData.longitude,mapInitialized,marker]);// Validation du formulaire avant soumission\nconst validateForm=()=>{// V√©rifier les champs obligatoires\nif(!formData.titre||!formData.date_evenement||!formData.heure_evenement||!formData.id_type_evenement||!formData.description_globale||!formData.id_zone){setSubmitStatus({type:'error',message:'Veuillez remplir tous les champs obligatoires (marqu√©s par *).'});return false;}// V√©rifier si au moins un champ a √©t√© modifi√©\nconst isModified=Object.keys(formData).some(key=>formData[key]!==ancienRapport[key]);if(!isModified){setSubmitStatus({type:'error',message:'Aucune modification d√©tect√©e. Modifiez au moins un champ pour enregistrer.'});return false;}return true;};// Fonction pour g√©rer l'envoi du formulaire\nconst handleArchiver=async e=>{const confirmation=window.confirm(\"Voulez-vous vraiment archiver ce rapport ? Cette action est irr√©versible.\");if(!confirmation)return;e.preventDefault();setIsSubmitting(true);setSubmitStatus(null);try{const dateTimeString=`${formData.date_evenement}T${formData.heure_evenement}:00`;const rapport={titre:formData.titre,date_evenement:dateTimeString,description_globale:formData.description_globale,id_operateur:authData.Opid,id_type_evenement:formData.id_type_evenement?parseInt(formData.id_type_evenement):null,id_sous_type_evenement:formData.id_sous_type_evenement?parseInt(formData.id_sous_type_evenement):null,id_origine_evenement:formData.id_origine_evenement?parseInt(formData.id_origine_evenement):null,archive:1// Archiver le rapport\n};const metaData={cible:{id_cible:formData.id_cible||null,nom_cible:formData.nom_cible||null,pavillon_cible:formData.pavillon_cible||null,libelle:formData.libelle||null},localisation:{id_zone:formData.id_zone?parseInt(formData.id_zone):null,details_lieu:formData.details_lieu||null,latitude:formData.latitude?parseFloat(formData.latitude):null,longitude:formData.longitude?parseFloat(formData.longitude):null},meteo:{direction_vent:formData.direction_vent||null,force_vent:formData.force_vent?parseInt(formData.force_vent):null,etat_mer:formData.etat_mer?parseInt(formData.etat_mer):null,nebulosite:formData.nebulosite?parseInt(formData.nebulosite):null},alertes:{cedre_alerte:formData.cedre_alerte?1:0,cross_alerte:formData.cross_alerte?1:0,photo:formData.photo?1:0,polrep:formData.polrep?1:0,derive_mothy:formData.derive_mothy?1:0,polmar_terre:formData.polmar_terre?1:0,smp:formData.smp?1:0,bsaa:formData.bsaa?1:0,delai_appareillage:formData.delai_appareillage||null}};// Envoi du PUT vers l'API\nconst response=await axios.put(`${API}/rapports/${id}/after`,{rapport,metaData});function genererDetailAction(ancien,nouveau){console.log('Ancien rapport:',ancien);const modifications=[];// Parcours des champs du nouveau rapport\nfor(const champ in nouveau){const ancienVal=ancien[champ];const nouveauVal=nouveau[champ];// Si les valeurs sont diff√©rentes, on les ajoute aux modifications\nif(ancienVal!==nouveauVal){modifications.push(`${champ} : \"${ancienVal}\" ‚Üí \"${nouveauVal}\"`);}}// Retourne un message selon qu'il y ait des modifications ou non\nreturn modifications.length>0?`Champs modifi√©s :\\n- ${modifications.join('\\n- ')}`:'Aucune modification d√©tect√©e';}// Fonction pour formater la valeur (en tenant compte des valeurs null/undefined et autres types)\nfunction formatValeur(val){if(val===null||val===undefined){return'';// Retourne une cha√Æne vide si la valeur est null ou undefined\n}// Si la valeur est un bool√©en, on la transforme en cha√Æne de caract√®res\nif(typeof val==='boolean'){return val?'Oui':'Non';}// Si la valeur est un nombre, on retourne son formatage\nif(typeof val==='number'){return val.toString();}// Pour les autres types de valeurs (cha√Ænes, objets, tableaux, etc.), on retourne la valeur sous forme de cha√Æne\nreturn val.toString();}// G√âN√âRATION DU DETAIL_ACTION AVANC√â\nconst detail_action=genererDetailAction(ancienRapport,formData);console.log('detail_action:',detail_action);await axios.post(`${API}/rapports/historique`,{id_rapport:id,id_operateur:authData.Opid,type_action:'Modification Rapport',date_action:new Date(new Date().getTime()+2*60*60*1000).toISOString(),detail_action});console.log('Rapport archiv√© avec succ√®s:',response.data);setSubmitStatus({type:'success',message:'Rapport mis √† jour avec succ√®s!'});setTimeout(()=>{navigate('/liste-rapports');},2000);}catch(error){var _error$response,_error$response$data;console.error('Erreur lors de la mise √† jour du rapport:',error);setSubmitStatus({type:'error',message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Une erreur est survenue lors de la mise √† jour du rapport.'});}finally{setIsSubmitting(false);}};const handleSubmit=async e=>{e.preventDefault();if(!validateForm())return;setIsSubmitting(true);setSubmitStatus(null);try{const dateTimeString=`${formData.date_evenement}T${formData.heure_evenement}:00`;const rapport={titre:formData.titre,date_evenement:dateTimeString,description_globale:formData.description_globale,id_operateur:authData.Opid,id_type_evenement:formData.id_type_evenement?parseInt(formData.id_type_evenement):null,id_sous_type_evenement:formData.id_sous_type_evenement?parseInt(formData.id_sous_type_evenement):null,id_origine_evenement:formData.id_origine_evenement?parseInt(formData.id_origine_evenement):null};const metaData={cible:{id_cible:formData.id_cible||null,nom_cible:formData.nom_cible||null,pavillon_cible:formData.pavillon_cible||null,libelle:formData.libelle||null},localisation:{id_zone:formData.id_zone?parseInt(formData.id_zone):null,details_lieu:formData.details_lieu||null,latitude:formData.latitude?parseFloat(formData.latitude):null,longitude:formData.longitude?parseFloat(formData.longitude):null},meteo:{direction_vent:formData.direction_vent||null,force_vent:formData.force_vent?parseInt(formData.force_vent):null,etat_mer:formData.etat_mer?parseInt(formData.etat_mer):null,nebulosite:formData.nebulosite?parseInt(formData.nebulosite):null},alertes:{cedre_alerte:formData.cedre_alerte?1:0,cross_alerte:formData.cross_alerte?1:0,photo:formData.photo?1:0,polrep:formData.polrep?1:0,derive_mothy:formData.derive_mothy?1:0,polmar_terre:formData.polmar_terre?1:0,smp:formData.smp?1:0,bsaa:formData.bsaa?1:0,delai_appareillage:formData.delai_appareillage||null}};// Envoi du PUT vers l'API\nconst response=await axios.put(`${API}/rapports/${id}/after`,{rapport,metaData});function genererDetailAction(ancien,nouveau){console.log('Ancien rapport:',ancien);const modifications=[];// Parcours des champs du nouveau rapport\nfor(const champ in nouveau){const ancienVal=ancien[champ];const nouveauVal=nouveau[champ];// Si les valeurs sont diff√©rentes, on les ajoute aux modifications\nif(ancienVal!==nouveauVal){modifications.push(`${champ} : \"${ancienVal}\" ‚Üí \"${nouveauVal}\"`);}}// Retourne un message selon qu'il y ait des modifications ou non\nreturn modifications.length>0?`Champs modifi√©s :\\n- ${modifications.join('\\n- ')}`:'Aucune modification d√©tect√©e';}// Fonction pour formater la valeur (en tenant compte des valeurs null/undefined et autres types)\nfunction formatValeur(val){if(val===null||val===undefined){return'';// Retourne une cha√Æne vide si la valeur est null ou undefined\n}// Si la valeur est un bool√©en, on la transforme en cha√Æne de caract√®res\nif(typeof val==='boolean'){return val?'Oui':'Non';}// Si la valeur est un nombre, on retourne son formatage\nif(typeof val==='number'){return val.toString();}// Pour les autres types de valeurs (cha√Ænes, objets, tableaux, etc.), on retourne la valeur sous forme de cha√Æne\nreturn val.toString();}// G√âN√âRATION DU DETAIL_ACTION AVANC√â\nconst detail_action=genererDetailAction(ancienRapport,formData);console.log('detail_action:',detail_action);await axios.post(`${API}/rapports/historique`,{id_rapport:id,id_operateur:authData.Opid,type_action:'Modification Rapport',date_action:new Date(new Date().getTime()+2*60*60*1000).toISOString(),detail_action});console.log('Rapport mis √† jour avec succ√®s:',response.data);setSubmitStatus({type:'success',message:'Rapport mis √† jour avec succ√®s!'});setTimeout(()=>{navigate('/liste-rapports');},2000);}catch(error){var _error$response2,_error$response2$data;console.error('Erreur lors de la mise √† jour du rapport:',error);setSubmitStatus({type:'error',message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Une erreur est survenue lors de la mise √† jour du rapport.'});}finally{setIsSubmitting(false);}};if(loading)return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des donn\\xE9es du rapport...\"})]});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"error-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Erreur\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>navigate('/liste-rapports'),children:\"Retour \\xE0 la liste des rapports\"})]});if(!accessChecked){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"V\\xE9rification des permissions...\"})]});}if(!hasAccess){return/*#__PURE__*/_jsxs(\"div\",{className:\"error-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Acc\\xE8s refus\\xE9\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Vous n'avez pas les droits pour modifier ce rapport.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>navigate('/liste-rapports'),children:\"Retour \\xE0 la liste des rapports\"})]});}// Afficher le champ de d√©lai d'appareillage seulement si BSAA est coch√©\nconst showDelaiAppareillage=formData.bsaa;return/*#__PURE__*/_jsxs(\"div\",{className:\"rapport-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rapport-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Modifier Un rapport d'Evenement\"}),/*#__PURE__*/_jsx(\"p\",{className:\"rapport-subtitle\",style:{fontSize:'0.9em',fontStyle:'italic'},children:\"Compl\\xE9tez tous les champs obligatoires (*) pour soumettre un nouveau rapport\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"rapport-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Informations G\\xE9n\\xE9rales\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"titre\",children:[\"Titre du rapport *\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Donnez un titre court et descriptif\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"titre\",type:\"text\",name:\"titre\",value:formData.titre,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: Incident de d\\xE9versement dans le secteur nord\",required:true,maxLength:\"200\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"date_evenement\",children:[\"Date de l'\\xE9v\\xE9nement *\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Date \\xE0 laquelle l'\\xE9v\\xE9nement s'est produit\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"date_evenement\",type:\"date\",name:\"date_evenement\",value:formData.date_evenement,onChange:handleChange,className:\"form-control\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"heure_evenement\",children:[\"Heure de l'\\xE9v\\xE9nement *\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Heure \\xE0 laquelle l'\\xE9v\\xE9nement s'est produit\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"heure_evenement\",type:\"time\",name:\"heure_evenement\",value:formData.heure_evenement,onChange:handleChange,className:\"form-control\",required:true})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Classification de l'\\xC9v\\xE9nement\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"id_type_evenement\",children:[\"Type d'\\xE9v\\xE9nement *\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Cat\\xE9gorie principale de l'\\xE9v\\xE9nement\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"id_type_evenement\",name:\"id_type_evenement\",value:formData.id_type_evenement,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- S\\xE9lectionner --\"}),typesEvenement.map(type=>/*#__PURE__*/_jsx(\"option\",{value:type.id_type_evenement,children:type.libelle},type.id_type_evenement))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"id_sous_type_evenement\",children:[\"Pr\\xE9cision du type d'\\xE9v\\xE9nement\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Sp\\xE9cification du type d'\\xE9v\\xE9nement\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"id_sous_type_evenement\",name:\"id_sous_type_evenement\",value:formData.id_sous_type_evenement,onChange:handleChange,className:\"form-control\",disabled:!formData.id_type_evenement,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- S\\xE9lectionner --\"}),filteredSousTypes.map(sousType=>/*#__PURE__*/_jsx(\"option\",{value:sousType.id_sous_type_evenement,children:sousType.libelle},sousType.id_sous_type_evenement))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"id_origine_evenement\",children:[\"Origine de l'\\xE9v\\xE9nement\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Source ou cause de l'\\xE9v\\xE9nement\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"id_origine_evenement\",name:\"id_origine_evenement\",value:formData.id_origine_evenement,onChange:handleChange,className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- S\\xE9lectionner --\"}),originesEvenement.map(origine=>/*#__PURE__*/_jsx(\"option\",{value:origine.id_origine_evenement,children:origine.libelle},origine.id_origine_evenement))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Cible de l'\\xC9v\\xE9nement\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"libelle\",children:[\"Type de cible\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Type d'objet ou entit\\xE9 cibl\\xE9 par l'\\xE9v\\xE9nement\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"libelle\",name:\"libelle\",value:formData.libelle,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: Navire, Installation, etc.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"nom_cible\",children:[\"Nom de la cible\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Nom du navire, de l'installation, etc.\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"nom_cible\",type:\"text\",name:\"nom_cible\",value:formData.nom_cible,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: Navire Cargo XYZ\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"pavillon_cible\",children:[\"Pavillon\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Pays d'enregistrement (pour navires)\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"pavillon_cible\",type:\"text\",name:\"pavillon_cible\",value:formData.pavillon_cible,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: France\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"immatriculation\",children:[\"Immatriculation\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"MMSI/IMO Info immatriculation\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"immatriculation\",type:\"text\",name:\"immatriculation\",value:formData.immatriculation,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: MMSI/IMO Info immatriculation\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"TypeProduit\",children:[\"Type Produit\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Type Produit\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"TypeProduit\",type:\"text\",name:\"TypeProduit\",value:formData.TypeProduit,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: fioul lourd, Huile, etc.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"QuantiteProduit\",children:[\"Quantite Produit\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Quantite de Produit\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"QuantiteProduit\",type:\"text\",name:\"QuantiteProduit\",value:formData.QuantiteProduit,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: 1000L, 1000T, etc.\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Localisation de l'\\xC9v\\xE9nement\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"id_zone\",children:[\"Zone g\\xE9ographique *\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Mer ou zone maritime o\\xF9 s'est produit l'\\xE9v\\xE9nement\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"id_zone\",name:\"id_zone\",value:formData.id_zone,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- S\\xE9lectionner une zone --\"}),zonesGeographiques.map(zone=>/*#__PURE__*/_jsx(\"option\",{value:zone.id_zone,children:zone.nom_zone},zone.id_zone))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"details_lieu\",children:[\"Pr\\xE9cision sur le lieu\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Description pr\\xE9cise de l'emplacement\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"textarea\",{id:\"details_lieu\",name:\"details_lieu\",value:formData.details_lieu,onChange:handleChange,className:\"form-control\",placeholder:\"D\\xE9crivez l'emplacement pr\\xE9cis (ex: 2 milles nautiques au sud du port de...\",rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"latitude\",children:[\"Latitude\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Format d\\xE9cimal (ex: 43.296398)\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"latitude\",type:\"text\",name:\"latitude\",value:formData.latitude,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: 43.296398\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"longitude\",children:[\"Longitude\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Format d\\xE9cimal (ex: 5.369779)\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"longitude\",type:\"text\",name:\"longitude\",value:formData.longitude,onChange:handleChange,className:\"form-control\",placeholder:\"Ex: 5.369779\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"map-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"S\\xE9lectionnez un point sur la carte (cliquez pour d\\xE9finir les coordonn\\xE9es)\"}),/*#__PURE__*/_jsx(\"div\",{ref:mapRef,id:\"map\",className:\"location-map\",style:{height:'300px',width:'100%',marginTop:'10px'},children:!mapInitialized&&/*#__PURE__*/_jsx(\"div\",{className:\"map-loading\",children:\"Chargement de la carte...\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Conditions M\\xE9t\\xE9orologiques\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"direction_vent\",children:[\"Direction du vent\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Direction d'o\\xF9 vient le vent\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"direction_vent\",name:\"direction_vent\",value:formData.direction_vent,onChange:handleChange,className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- S\\xE9lectionner --\"}),/*#__PURE__*/_jsx(\"option\",{value:\"N\",children:\"Nord (N)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"NE\",children:\"Nord-Est (NE)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"E\",children:\"Est (E)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"SE\",children:\"Sud-Est (SE)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"S\",children:\"Sud (S)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"SO\",children:\"Sud-Ouest (SO)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"O\",children:\"Ouest (O)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"NO\",children:\"Nord-Ouest (NO)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"maree\",children:[\"Mar\\xE9e\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"\\xC9tat actuel de la mar\\xE9e (observation au moment du rapport)\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"maree\",name:\"maree\",value:formData.maree,onChange:handleChange,className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- S\\xE9lectionner --\"}),/*#__PURE__*/_jsx(\"option\",{value:\"haute\",children:\"Haute mer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"basse\",children:\"Basse mer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"montante\",children:\"Mar\\xE9e montante\"}),/*#__PURE__*/_jsx(\"option\",{value:\"descendante\",children:\"Mar\\xE9e descendante\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"force_vent\",children:[\"Force du vent (0-12)\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"\\xC9chelle de Beaufort de 0 \\xE0 12\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",id:\"force_vent\",name:\"force_vent\",min:\"0\",max:\"12\",value:formData.force_vent,onChange:handleChange,className:\"form-control-range\"}),/*#__PURE__*/_jsx(\"div\",{className:\"range-value\",children:formData.force_vent||'0'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"etat_mer\",children:[\"\\xC9tat de la mer (0-9)\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"\\xC9chelle de Douglas de 0 \\xE0 9\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",id:\"etat_mer\",name:\"etat_mer\",min:\"0\",max:\"9\",value:formData.etat_mer,onChange:handleChange,className:\"form-control-range\"}),/*#__PURE__*/_jsx(\"div\",{className:\"range-value\",children:formData.etat_mer||'0'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"nebulosite\",children:[\"N\\xE9bulosit\\xE9 (0-9)\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"\\xC9chelle de couverture nuageuse de 0 \\xE0 9\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",id:\"nebulosite\",name:\"nebulosite\",min:\"0\",max:\"9\",value:formData.nebulosite,onChange:handleChange,className:\"form-control-range\"}),/*#__PURE__*/_jsx(\"div\",{className:\"range-value\",children:formData.nebulosite||'0'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Contacts et Alertes\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"cedre_alerte\",type:\"checkbox\",name:\"cedre_alerte\",checked:formData.cedre_alerte,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"cedre_alerte\",children:\"CEDRE alert\\xE9\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"cross_alerte\",type:\"checkbox\",name:\"cross_alerte\",checked:formData.cross_alerte,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"cross_alerte\",children:\"CROSS alert\\xE9\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"photo\",type:\"checkbox\",name:\"photo\",checked:formData.photo,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"photo\",children:\"Photo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"message_polrep\",type:\"checkbox\",name:\"message_polrep\",checked:formData.message_polrep,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"message_polrep\",children:\"POLREP\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"derive_mothy\",type:\"checkbox\",name:\"derive_mothy\",checked:formData.derive_mothy,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"derive_mothy\",children:\"D\\xE9rive MOTHY\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"polmar_terre\",type:\"checkbox\",name:\"polmar_terre\",checked:formData.polmar_terre,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"polmar_terre\",children:\"POLMAR Terre\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"smp\",type:\"checkbox\",name:\"smp\",checked:formData.smp,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"smp\",children:\"SMP\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"sensible_proximite\",type:\"checkbox\",name:\"sensible_proximite\",checked:formData.sensible_proximite,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"sensible_proximite\",children:\"Site sensible \\xE0 proximit\\xE9\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-item\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"bsaa\",type:\"checkbox\",name:\"bsaa\",checked:formData.bsaa,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"bsaa\",children:\"BSAA\"})]})]}),showDelaiAppareillage&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"delai_appareillage\",children:[\"D\\xE9lai d'appareillage\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"Date et heure d'appareillage pour BSAA\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"delai_appareillage\",type:\"datetime-local\",name:\"delai_appareillage\",value:formData.delai_appareillage,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"moyen_proximite\",children:\"Moyens \\xE0 proximit\\xE9\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"moyen_proximite\",name:\"moyen_proximite\",value:formData.moyen_proximite,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"moyen_depeche\",children:\"Moyens d\\xE9p\\xEAch\\xE9s sur zone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"moyen_depeche\",name:\"moyen_depeche\",value:formData.moyen_depeche,onChange:handleChange,className:\"form-control\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"moyen_marine_etat\",children:\"Moyens maritimes ou de l\\u2019\\xC9tat\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"moyen_marine_etat\",name:\"moyen_marine_etat\",value:formData.moyen_marine_etat,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"risque_court_terme\",children:\"Risque pr\\xE9visible \\xE0 court terme\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"risque_court_terme\",name:\"risque_court_terme\",value:formData.risque_court_terme,onChange:handleChange,className:\"form-control\",rows:3})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"risque_moyen_long_terme\",children:\"Risque pr\\xE9visible \\xE0 moyen et long terme\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"risque_moyen_long_terme\",name:\"risque_moyen_long_terme\",value:formData.risque_moyen_long_terme,onChange:handleChange,className:\"form-control\",rows:3})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Description D\\xE9taill\\xE9e\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"description_globale\",children:[\"Description globale de l'\\xE9v\\xE9nement *\",/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"D\\xE9crivez en d\\xE9tail ce qui s'est pass\\xE9\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description_globale\",name:\"description_globale\",value:formData.description_globale,onChange:handleChange,className:\"form-control\",placeholder:\"D\\xE9crivez l'\\xE9v\\xE9nement de mani\\xE8re d\\xE9taill\\xE9e : que s'est-il pass\\xE9, o\\xF9, quand, comment...\",required:true,rows:\"6\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:`btn-primary ${isSubmitting?'loading':''}`,disabled:isSubmitting,children:isSubmitting?'Modification ...':'Modifier le rapport'})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:handleArchiver,style:{backgroundColor:'#a00',color:'white',padding:'10px 20px',fontSize:'1rem',marginTop:'1rem'},children:\"\\uD83D\\uDDC3\\uFE0F Archiver ce rapport\"})})]}),/*#__PURE__*/_jsx(\"br\",{}),submitStatus&&/*#__PURE__*/_jsx(\"div\",{className:`status-message ${submitStatus.type}`,children:submitStatus.message})]});};export default ModifierRapport;","map":{"version":3,"names":["useState","useEffect","useRef","useAuth","useParams","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","API","process","env","REACT_APP_API_URL","ModifierRapport","id","navigate","authData","hasAccess","setHasAccess","accessChecked","setAccessChecked","checkAccess","accesResponse","get","accesList","data","rapportResponse","rapport","estCreateur","id_operateur","Opid","aAccess","some","acc","error","console","isSubmitting","setIsSubmitting","submitStatus","setSubmitStatus","loading","setLoading","setError","mapRef","leafletMapRef","mapInitialized","setMapInitialized","marker","setMarker","typesEvenement","setTypesEvenement","sousTypesEvenement","setSousTypesEvenement","originesEvenement","setOriginesEvenement","typesCibleRes","setTypesCible","zonesGeographiques","setZonesGeographiques","filteredSousTypes","setFilteredSousTypes","initialFormData","titre","date_evenement","heure_evenement","description_globale","id_type_evenement","id_sous_type_evenement","id_origine_evenement","id_cible","nom_cible","pavillon_cible","libelle","immatriculation","TypeProduit","QuantiteProduit","id_zone","details_lieu","latitude","longitude","direction_vent","force_vent","etat_mer","nebulosite","maree","cedre_alerte","cross_alerte","photo","message_polrep","derive_mothy","polmar_terre","smp","bsaa","sensible_proximite","moyen_proximite","moyen_depeche","moyen_marine_etat","risque_court_terme","risque_moyen_long_terme","delai_appareillage","formData","setFormData","ancienRapport","setAncienRapport","fetchData","log","_rapportData$id_type_","_rapportData$id_sous_","_rapportData$id_origi","_metaData$cible","_metaData$cible$id_ty","_metaData$cible2","_metaData$cible3","_metaData$typeCible","_metaData$cible4","_metaData$cible5","_metaData$cible6","_metaData$localisatio","_metaData$localisatio2","_metaData$localisatio3","_metaData$localisatio4","_metaData$localisatio5","_metaData$localisatio6","_metaData$localisatio7","_metaData$meteo","_metaData$meteo2","_metaData$meteo2$forc","_metaData$meteo3","_metaData$meteo3$etat","_metaData$meteo4","_metaData$meteo4$nebu","_metaData$meteo5","_metaData$alertes","_metaData$alertes2","_metaData$alertes3","_metaData$alertes4","_metaData$alertes5","_metaData$alertes6","_metaData$alertes7","_metaData$alertes8","_metaData$alertes9","_metaData$alertes10","_metaData$alertes11","_metaData$alertes12","_metaData$alertes13","_metaData$alertes14","_metaData$alertes15","typesRes","sousTypesRes","originesRes","zonesRes","rapportRes","Promise","all","rapportData","metaData","dateEvenement","heureEvenement","dateObj","Date","toISOString","split","toTimeString","substring","newFormData","toString","cible","id_type_cible","nom","pavillon","typeCible","localisation","meteo","alertes","cedre","cross_contact","polrep","pne","delai_appareillage_bsaa","err","filtered","filter","sousType","parseInt","current","window","L","script","document","createElement","src","integrity","crossOrigin","querySelector","link","rel","href","head","appendChild","onload","initMap","remove","initialPosition","parseFloat","map","setView","tileLayer","attribution","addTo","newMarker","on","e","lat","lng","latlng","prev","toFixed","setLatLng","setTimeout","invalidateSize","handleChange","name","value","type","checked","target","newValue","isNaN","validateForm","message","isModified","Object","keys","key","handleArchiver","confirmation","confirm","preventDefault","dateTimeString","archive","response","put","genererDetailAction","ancien","nouveau","modifications","champ","ancienVal","nouveauVal","push","length","join","formatValeur","val","undefined","detail_action","post","id_rapport","type_action","date_action","getTime","_error$response","_error$response$data","handleSubmit","_error$response2","_error$response2$data","className","children","onClick","showDelaiAppareillage","style","fontSize","fontStyle","onSubmit","htmlFor","title","onChange","placeholder","required","maxLength","disabled","origine","zone","nom_zone","rows","ref","height","width","marginTop","min","max","backgroundColor","color","padding"],"sources":["D:/Stage/MarineV3/frontend/src/components/pages/ModifierRapport.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport '../css/AjouterRapport.css'; // Utilisation du m√™me fichier CSS pour la coh√©rence visuelle\r\n\r\n\r\n\r\n\r\n\r\nconst API = process.env.REACT_APP_API_URL;\r\n\r\nconst ModifierRapport = () => {\r\n\r\n  const { id } = useParams(); // r√©cup√®re l'id depuis l'URL\r\n  const navigate = useNavigate();\r\n  const { authData } = useAuth();\r\n\r\n\r\n  const [hasAccess, setHasAccess] = useState(false);\r\n  const [accessChecked, setAccessChecked] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkAccess = async () => {\r\n      try {\r\n        const accesResponse = await axios.get(`${API}/rapports/${id}/acces`);\r\n        const accesList = accesResponse.data;\r\n\r\n        const rapportResponse = await axios.get(`${API}/rapports/${id}`);\r\n        const rapport = rapportResponse.data.rapport || rapportResponse.data;\r\n\r\n        const estCreateur = rapport.id_operateur === authData.Opid;\r\n        const aAccess = accesList.some(acc => acc.id_operateur === authData.Opid);\r\n\r\n        setHasAccess(estCreateur || aAccess);\r\n\r\n\r\n        if (estCreateur || aAccess) {\r\n          setHasAccess(true);\r\n        } else {\r\n          setHasAccess(false);\r\n        }\r\n      } catch (error) {\r\n        console.error('Erreur lors de la v√©rification de l\\'acc√®s :', error);\r\n        setHasAccess(false);\r\n      } finally {\r\n        setAccessChecked(true);\r\n      }\r\n    };\r\n    checkAccess();\r\n  }, [authData, id]);\r\n\r\n\r\n\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [submitStatus, setSubmitStatus] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const mapRef = useRef(null);\r\n  const leafletMapRef = useRef(null);\r\n  const [mapInitialized, setMapInitialized] = useState(false);\r\n  const [marker, setMarker] = useState(null);\r\n\r\n  // √âtats pour les listes d√©roulantes\r\n  const [typesEvenement, setTypesEvenement] = useState([]);\r\n  const [sousTypesEvenement, setSousTypesEvenement] = useState([]);\r\n  const [originesEvenement, setOriginesEvenement] = useState([]);\r\n  const [typesCibleRes, setTypesCible] = useState([]);\r\n  const [zonesGeographiques, setZonesGeographiques] = useState([]);\r\n  const [filteredSousTypes, setFilteredSousTypes] = useState([]);\r\n\r\n\r\n\r\n  const initialFormData = {\r\n    titre: '',\r\n    date_evenement: '',\r\n    heure_evenement: '',\r\n    description_globale: '',\r\n    id_type_evenement: '',\r\n    id_sous_type_evenement: '',\r\n    id_origine_evenement: '',\r\n    id_cible: '',\r\n    nom_cible: '',\r\n    pavillon_cible: '',\r\n    libelle: '',\r\n    immatriculation: '',\r\n    TypeProduit: '',\r\n    QuantiteProduit: '',\r\n    id_zone: '',\r\n    details_lieu: '',\r\n    latitude: '',\r\n    longitude: '',\r\n    direction_vent: '',\r\n    force_vent: '',\r\n    etat_mer: '',\r\n    nebulosite: '',\r\n    maree: '',\r\n    cedre_alerte: false,\r\n    cross_alerte: false,\r\n    photo: false,\r\n    message_polrep: false,\r\n    derive_mothy: false,\r\n    polmar_terre: false,\r\n    smp: false,\r\n    bsaa: false,\r\n    sensible_proximite: false,\r\n    moyen_proximite: '',\r\n    moyen_depeche: '',\r\n    moyen_marine_etat: '',\r\n    risque_court_terme: '',\r\n    risque_moyen_long_terme: '',\r\n    delai_appareillage: ''\r\n  };\r\n\r\n  const [formData, setFormData] = useState(initialFormData);\r\n  const [ancienRapport, setAncienRapport] = useState(initialFormData);\r\n\r\n\r\n\r\n\r\n\r\n\r\n  // Chargement des donn√©es du rapport et des listes d√©roulantes\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      console.log('üì• D√©but du chargement des donn√©es du rapport et des listes d√©roulantes...');\r\n      try {\r\n        setLoading(true);\r\n        setError('');\r\n\r\n        console.log('üîÑ Requ√™tes en cours vers l\\'API...');\r\n        const [\r\n          typesRes,\r\n          sousTypesRes,\r\n          originesRes,\r\n          zonesRes,\r\n          typesCibleRes,\r\n          rapportRes,\r\n        ] = await Promise.all([\r\n          axios.get(`${API}/rapports/type-evenement`),\r\n          axios.get(`${API}/rapports/sous-type-pollution`),\r\n          axios.get(`${API}/rapports/origine-evenement`),\r\n          axios.get(`${API}/rapports/zone-geographique`),\r\n          axios.get(`${API}/rapports/type-cible`),\r\n          axios.get(`${API}/rapports/${id}`),\r\n        ]);\r\n\r\n        console.log('‚úÖ Donn√©es des listes d√©roulantes r√©cup√©r√©es avec succ√®s.');\r\n\r\n        // Mise √† jour des listes\r\n        setTypesEvenement(typesRes.data);\r\n        setSousTypesEvenement(sousTypesRes.data);\r\n        setOriginesEvenement(originesRes.data);\r\n        setZonesGeographiques(zonesRes.data);\r\n        setTypesCible(typesCibleRes.data);\r\n\r\n        console.log('üì¶ R√©cup√©ration et traitement des donn√©es du rapport...');\r\n        const rapportData = rapportRes.data.rapport || rapportRes.data;\r\n        const metaData = rapportRes.data.metaData || {};\r\n\r\n        // üßæ Affichage brut des donn√©es r√©cup√©r√©es\r\n        console.log('üìÑ Donn√©es du rapport r√©cup√©r√©es :', rapportData);\r\n        console.log('üìÑ MetaData associ√©es :', metaData);\r\n\r\n        // Formatage date/heure locale\r\n        let dateEvenement = '';\r\n        let heureEvenement = '';\r\n\r\n        if (rapportData.date_evenement) {\r\n          const dateObj = new Date(rapportData.date_evenement);\r\n          dateEvenement = dateObj.toISOString().split('T')[0];\r\n          heureEvenement = dateObj.toTimeString().substring(0, 5);\r\n          console.log(`üïí Date UTC re√ßue : ${rapportData.date_evenement} ‚Üí affich√©e : ${dateEvenement} ${heureEvenement}`);\r\n        }\r\n\r\n        const newFormData = {\r\n          titre: rapportData.titre || '',\r\n          date_evenement: dateEvenement,\r\n          heure_evenement: heureEvenement,\r\n          description_globale: rapportData.description_globale || '',\r\n          id_type_evenement: rapportData.id_type_evenement?.toString() || '',\r\n          id_sous_type_evenement: rapportData.id_sous_type_evenement?.toString() || '',\r\n          id_origine_evenement: rapportData.id_origine_evenement?.toString() || '',\r\n\r\n          id_cible: metaData.cible?.id_type_cible?.toString() || '',\r\n          nom_cible: metaData.cible?.nom || '',\r\n          pavillon_cible: metaData.cible?.pavillon || '',\r\n          libelle: metaData.typeCible?.libelle || '',\r\n          immatriculation: metaData.cible?.immatriculation || '',\r\n          TypeProduit: metaData.cible?.TypeProduit || '',\r\n          QuantiteProduit: metaData.cible?.QuantiteProduit || '',\r\n\r\n          id_zone: metaData.localisation?.id_zone?.toString() || '',\r\n          details_lieu: metaData.localisation?.details_lieu || '',\r\n          latitude: metaData.localisation?.latitude?.toString() || '',\r\n          longitude: metaData.localisation?.longitude?.toString() || '',\r\n\r\n          direction_vent: metaData.meteo?.direction_vent || '',\r\n          force_vent: metaData.meteo?.force_vent?.toString() || '',\r\n          etat_mer: metaData.meteo?.etat_mer?.toString() || '',\r\n          nebulosite: metaData.meteo?.nebulosite?.toString() || '',\r\n          maree: metaData.meteo?.maree || '',\r\n\r\n          cedre_alerte: metaData.alertes?.cedre === 1,\r\n          cross_alerte: metaData.alertes?.cross_contact === 1,\r\n          photo: metaData.alertes?.photo === 1,\r\n          message_polrep: metaData.alertes?.polrep === 1,\r\n          derive_mothy: metaData.alertes?.derive_mothy === 1,\r\n          polmar_terre: metaData.alertes?.pne === 1,\r\n          smp: metaData.alertes?.smp === 1,\r\n          bsaa: metaData.alertes?.bsaa === 1,\r\n          sensible_proximite: metaData.alertes?.sensible_proximite === 1,\r\n\r\n          moyen_proximite: metaData.alertes?.moyen_proximite || '',\r\n          moyen_depeche: metaData.alertes?.moyen_depeche || '',\r\n          moyen_marine_etat: metaData.alertes?.moyen_marine_etat || '',\r\n\r\n          risque_court_terme: metaData.alertes?.risque_court_terme || '',\r\n          risque_moyen_long_terme: metaData.alertes?.risque_moyen_long_terme || '',\r\n\r\n          delai_appareillage: metaData.alertes?.delai_appareillage_bsaa || ''\r\n        };\r\n\r\n        console.log('üìù Formulaire pr√©rempli avec :', newFormData);\r\n        setFormData(newFormData);\r\n        setAncienRapport(newFormData);\r\n\r\n      } catch (err) {\r\n        console.error('‚ùå Erreur lors du chargement des donn√©es :', err);\r\n        setError('Impossible de charger les donn√©es du rapport.');\r\n      } finally {\r\n        setLoading(false);\r\n        console.log('‚úÖ Chargement termin√©.');\r\n      }\r\n    };\r\n\r\n\r\n\r\n    fetchData();\r\n  }, [id]);\r\n\r\n\r\n\r\n\r\n  // Supprimez le premier useEffect qui fait juste appel √† chargerRapport()\r\n\r\n\r\n  // Filtrer les sous-types en fonction du type s√©lectionn√©\r\n  useEffect(() => {\r\n    if (formData.id_type_evenement) {\r\n      const filtered = sousTypesEvenement.filter(\r\n        sousType => sousType.id_type_evenement === parseInt(formData.id_type_evenement)\r\n      );\r\n      setFilteredSousTypes(filtered);\r\n    } else {\r\n      setFilteredSousTypes([]);\r\n    }\r\n  }, [formData.id_type_evenement, sousTypesEvenement]);\r\n\r\n\r\n  // Initialisation de la carte Leaflet\r\n  useEffect(() => {\r\n    // S'assurer que la carte est initialis√©e une seule fois et correctement\r\n    if (mapRef.current && !mapInitialized && typeof window !== 'undefined' && formData.latitude && formData.longitude) {\r\n      // S'assurer que Leaflet est disponible\r\n      if (!window.L) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\r\n        script.integrity = 'sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=';\r\n        script.crossOrigin = '';\r\n\r\n        // Ajouter la feuille de style Leaflet si elle n'est pas d√©j√† pr√©sente\r\n        if (!document.querySelector('link[href*=\"leaflet.css\"]')) {\r\n          const link = document.createElement('link');\r\n          link.rel = 'stylesheet';\r\n          link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\r\n          link.integrity = 'sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=';\r\n          link.crossOrigin = '';\r\n          document.head.appendChild(link);\r\n        }\r\n\r\n        script.onload = initMap;\r\n        document.head.appendChild(script);\r\n      } else {\r\n        initMap();\r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    function initMap() {\r\n      try {\r\n        console.log(\"üó∫Ô∏è Initialisation de la carte...\");\r\n\r\n        // Nettoyer la carte pr√©c√©dente si elle existe\r\n        if (leafletMapRef.current) {\r\n          leafletMapRef.current.remove();\r\n        }\r\n\r\n        // Position initiale bas√©e sur les coordonn√©es du rapport si disponibles\r\n        const initialPosition = [\r\n          parseFloat(formData.latitude) ,\r\n          parseFloat(formData.longitude) \r\n        ];\r\n\r\n        // Cr√©er la nouvelle carte\r\n        leafletMapRef.current = window.L.map(mapRef.current).setView(initialPosition, 10);\r\n\r\n        // Ajouter la couche de tuiles OpenStreetMap\r\n        window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n        }).addTo(leafletMapRef.current);\r\n\r\n        // Ajouter un marqueur √† la position initiale si des coordonn√©es sont disponibles\r\n        if (formData.latitude && formData.longitude) {\r\n          const newMarker = window.L.marker(initialPosition).addTo(leafletMapRef.current);\r\n          setMarker(newMarker);\r\n        }\r\n\r\n        // Ajouter un gestionnaire de clic sur la carte\r\n        leafletMapRef.current.on('click', function (e) {\r\n          const { lat, lng } = e.latlng;\r\n\r\n          // Mettre √† jour les champs de latitude et longitude dans le formulaire\r\n          setFormData(prev => ({\r\n            ...prev,\r\n            latitude: lat.toFixed(6),\r\n            longitude: lng.toFixed(6)\r\n          }));\r\n\r\n          // Mettre √† jour ou cr√©er le marqueur\r\n          if (marker) {\r\n            marker.setLatLng([lat, lng]);\r\n          } else {\r\n            const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\r\n            setMarker(newMarker);\r\n          }\r\n\r\n          console.log(`Position s√©lectionn√©e: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\r\n        });\r\n\r\n        // Force la mise √† jour de la carte apr√®s l'initialisation\r\n        setTimeout(() => {\r\n          if (leafletMapRef.current) {\r\n            leafletMapRef.current.invalidateSize();\r\n          }\r\n        }, 200);\r\n\r\n        setMapInitialized(true);\r\n        console.log(\"‚úÖ Carte initialis√©e avec succ√®s\");\r\n      } catch (error) {\r\n        console.error('Erreur lors de l\\'initialisation de la carte:', error);\r\n      }\r\n    }\r\n\r\n    // Nettoyer la carte au d√©montage du composant\r\n    return () => {\r\n      if (leafletMapRef.current) {\r\n        leafletMapRef.current.remove();\r\n        leafletMapRef.current = null;\r\n      }\r\n    };\r\n  }, [formData.latitude, formData.longitude]);\r\n\r\n  // G√©rer les changements dans le formulaire\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n    const newValue = type === 'checkbox' ? checked : value;\r\n    setFormData(prev => ({ ...prev, [name]: newValue }));\r\n  };\r\n\r\n  // Mettre √† jour la carte si les coordonn√©es sont modifi√©es manuellement\r\n  useEffect(() => {\r\n    if (mapInitialized && leafletMapRef.current && formData.latitude && formData.longitude) {\r\n      const lat = parseFloat(formData.latitude);\r\n      const lng = parseFloat(formData.longitude);\r\n\r\n      if (!isNaN(lat) && !isNaN(lng)) {\r\n        // Centrer la carte sur les coordonn√©es saisies manuellement\r\n        leafletMapRef.current.setView([lat, lng], 12);\r\n\r\n        // Mettre √† jour ou cr√©er le marqueur\r\n        if (marker) {\r\n          marker.setLatLng([lat, lng]);\r\n        } else {\r\n          const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\r\n          setMarker(newMarker);\r\n        }\r\n      }\r\n    }\r\n  }, [formData.latitude, formData.longitude, mapInitialized, marker]);\r\n\r\n  // Validation du formulaire avant soumission\r\n  const validateForm = () => {\r\n    // V√©rifier les champs obligatoires\r\n    if (!formData.titre || !formData.date_evenement || !formData.heure_evenement ||\r\n      !formData.id_type_evenement || !formData.description_globale || !formData.id_zone) {\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: 'Veuillez remplir tous les champs obligatoires (marqu√©s par *).'\r\n      });\r\n      return false;\r\n    }\r\n\r\n    // V√©rifier si au moins un champ a √©t√© modifi√©\r\n    const isModified = Object.keys(formData).some(\r\n      key => formData[key] !== ancienRapport[key]\r\n    );\r\n    if (!isModified) {\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: 'Aucune modification d√©tect√©e. Modifiez au moins un champ pour enregistrer.'\r\n      });\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n\r\n  // Fonction pour g√©rer l'envoi du formulaire\r\n  const handleArchiver = async (e) => {\r\n\r\n    const confirmation = window.confirm(\"Voulez-vous vraiment archiver ce rapport ? Cette action est irr√©versible.\");\r\n\r\n    if (!confirmation) return;\r\n    e.preventDefault();\r\n\r\n    \r\n\r\n    setIsSubmitting(true);\r\n    setSubmitStatus(null);\r\n\r\n    try {\r\n      const dateTimeString = `${formData.date_evenement}T${formData.heure_evenement}:00`;\r\n\r\n      const rapport = {\r\n        titre: formData.titre,\r\n        date_evenement: dateTimeString,\r\n        description_globale: formData.description_globale,\r\n        id_operateur: authData.Opid,\r\n        id_type_evenement: formData.id_type_evenement ? parseInt(formData.id_type_evenement) : null,\r\n        id_sous_type_evenement: formData.id_sous_type_evenement ? parseInt(formData.id_sous_type_evenement) : null,\r\n        id_origine_evenement: formData.id_origine_evenement ? parseInt(formData.id_origine_evenement) : null,\r\n        archive : 1 // Archiver le rapport\r\n      };\r\n\r\n      const metaData = {\r\n        cible: {\r\n          id_cible: formData.id_cible || null,\r\n          nom_cible: formData.nom_cible || null,\r\n          pavillon_cible: formData.pavillon_cible || null,\r\n          libelle: formData.libelle || null,\r\n        },\r\n        localisation: {\r\n          id_zone: formData.id_zone ? parseInt(formData.id_zone) : null,\r\n          details_lieu: formData.details_lieu || null,\r\n          latitude: formData.latitude ? parseFloat(formData.latitude) : null,\r\n          longitude: formData.longitude ? parseFloat(formData.longitude) : null,\r\n        },\r\n        meteo: {\r\n          direction_vent: formData.direction_vent || null,\r\n          force_vent: formData.force_vent ? parseInt(formData.force_vent) : null,\r\n          etat_mer: formData.etat_mer ? parseInt(formData.etat_mer) : null,\r\n          nebulosite: formData.nebulosite ? parseInt(formData.nebulosite) : null,\r\n        },\r\n        alertes: {\r\n          cedre_alerte: formData.cedre_alerte ? 1 : 0,\r\n          cross_alerte: formData.cross_alerte ? 1 : 0,\r\n          photo: formData.photo ? 1 : 0,\r\n          polrep: formData.polrep ? 1 : 0,\r\n          derive_mothy: formData.derive_mothy ? 1 : 0,\r\n          polmar_terre: formData.polmar_terre ? 1 : 0,\r\n          smp: formData.smp ? 1 : 0,\r\n          bsaa: formData.bsaa ? 1 : 0,\r\n          delai_appareillage: formData.delai_appareillage || null,\r\n        }\r\n      };\r\n\r\n      // Envoi du PUT vers l'API\r\n      const response = await axios.put(`${API}/rapports/${id}/after`, {\r\n        rapport,\r\n        metaData\r\n      });\r\n\r\n\r\n      function genererDetailAction(ancien, nouveau) {\r\n        console.log('Ancien rapport:', ancien);\r\n\r\n        const modifications = [];\r\n\r\n        // Parcours des champs du nouveau rapport\r\n        for (const champ in nouveau) {\r\n          const ancienVal = ancien[champ];\r\n          const nouveauVal = nouveau[champ];\r\n\r\n          // Si les valeurs sont diff√©rentes, on les ajoute aux modifications\r\n          if (ancienVal !== nouveauVal) {\r\n            modifications.push(`${champ} : \"${ancienVal}\" ‚Üí \"${nouveauVal}\"`);\r\n          }\r\n        }\r\n\r\n        // Retourne un message selon qu'il y ait des modifications ou non\r\n        return modifications.length > 0\r\n          ? `Champs modifi√©s :\\n- ${modifications.join('\\n- ')}`\r\n          : 'Aucune modification d√©tect√©e';\r\n      }\r\n\r\n      // Fonction pour formater la valeur (en tenant compte des valeurs null/undefined et autres types)\r\n      function formatValeur(val) {\r\n        if (val === null || val === undefined) {\r\n          return ''; // Retourne une cha√Æne vide si la valeur est null ou undefined\r\n        }\r\n\r\n        // Si la valeur est un bool√©en, on la transforme en cha√Æne de caract√®res\r\n        if (typeof val === 'boolean') {\r\n          return val ? 'Oui' : 'Non';\r\n        }\r\n\r\n        // Si la valeur est un nombre, on retourne son formatage\r\n        if (typeof val === 'number') {\r\n          return val.toString();\r\n        }\r\n\r\n        // Pour les autres types de valeurs (cha√Ænes, objets, tableaux, etc.), on retourne la valeur sous forme de cha√Æne\r\n        return val.toString();\r\n      }\r\n\r\n\r\n\r\n      // G√âN√âRATION DU DETAIL_ACTION AVANC√â\r\n      const detail_action = genererDetailAction(ancienRapport, formData);\r\n\r\n      console.log('detail_action:', detail_action);\r\n      await axios.post(`${API}/rapports/historique`, {\r\n        id_rapport: id,\r\n        id_operateur: authData.Opid,\r\n        type_action: 'Modification Rapport',\r\n        date_action: new Date(new Date().getTime() + 2 * 60 * 60 * 1000).toISOString(),\r\n        detail_action\r\n      });\r\n\r\n      console.log('Rapport archiv√© avec succ√®s:', response.data);\r\n      setSubmitStatus({ type: 'success', message: 'Rapport mis √† jour avec succ√®s!' });\r\n\r\n      setTimeout(() => {\r\n        navigate('/liste-rapports');\r\n      }, 2000);\r\n    } catch (error) {\r\n      console.error('Erreur lors de la mise √† jour du rapport:', error);\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: error.response?.data?.message || 'Une erreur est survenue lors de la mise √† jour du rapport.'\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!validateForm()) return;\r\n\r\n    setIsSubmitting(true);\r\n    setSubmitStatus(null);\r\n\r\n    try {\r\n      const dateTimeString = `${formData.date_evenement}T${formData.heure_evenement}:00`;\r\n\r\n      const rapport = {\r\n        titre: formData.titre,\r\n        date_evenement: dateTimeString,\r\n        description_globale: formData.description_globale,\r\n        id_operateur: authData.Opid,\r\n        id_type_evenement: formData.id_type_evenement ? parseInt(formData.id_type_evenement) : null,\r\n        id_sous_type_evenement: formData.id_sous_type_evenement ? parseInt(formData.id_sous_type_evenement) : null,\r\n        id_origine_evenement: formData.id_origine_evenement ? parseInt(formData.id_origine_evenement) : null,\r\n      };\r\n\r\n      const metaData = {\r\n        cible: {\r\n          id_cible: formData.id_cible || null,\r\n          nom_cible: formData.nom_cible || null,\r\n          pavillon_cible: formData.pavillon_cible || null,\r\n          libelle: formData.libelle || null,\r\n        },\r\n        localisation: {\r\n          id_zone: formData.id_zone ? parseInt(formData.id_zone) : null,\r\n          details_lieu: formData.details_lieu || null,\r\n          latitude: formData.latitude ? parseFloat(formData.latitude) : null,\r\n          longitude: formData.longitude ? parseFloat(formData.longitude) : null,\r\n        },\r\n        meteo: {\r\n          direction_vent: formData.direction_vent || null,\r\n          force_vent: formData.force_vent ? parseInt(formData.force_vent) : null,\r\n          etat_mer: formData.etat_mer ? parseInt(formData.etat_mer) : null,\r\n          nebulosite: formData.nebulosite ? parseInt(formData.nebulosite) : null,\r\n        },\r\n        alertes: {\r\n          cedre_alerte: formData.cedre_alerte ? 1 : 0,\r\n          cross_alerte: formData.cross_alerte ? 1 : 0,\r\n          photo: formData.photo ? 1 : 0,\r\n          polrep: formData.polrep ? 1 : 0,\r\n          derive_mothy: formData.derive_mothy ? 1 : 0,\r\n          polmar_terre: formData.polmar_terre ? 1 : 0,\r\n          smp: formData.smp ? 1 : 0,\r\n          bsaa: formData.bsaa ? 1 : 0,\r\n          delai_appareillage: formData.delai_appareillage || null,\r\n        }\r\n      };\r\n\r\n      // Envoi du PUT vers l'API\r\n      const response = await axios.put(`${API}/rapports/${id}/after`, {\r\n        rapport,\r\n        metaData\r\n      });\r\n\r\n\r\n      function genererDetailAction(ancien, nouveau) {\r\n        console.log('Ancien rapport:', ancien);\r\n\r\n        const modifications = [];\r\n\r\n        // Parcours des champs du nouveau rapport\r\n        for (const champ in nouveau) {\r\n          const ancienVal = ancien[champ];\r\n          const nouveauVal = nouveau[champ];\r\n\r\n          // Si les valeurs sont diff√©rentes, on les ajoute aux modifications\r\n          if (ancienVal !== nouveauVal) {\r\n            modifications.push(`${champ} : \"${ancienVal}\" ‚Üí \"${nouveauVal}\"`);\r\n          }\r\n        }\r\n\r\n        // Retourne un message selon qu'il y ait des modifications ou non\r\n        return modifications.length > 0\r\n          ? `Champs modifi√©s :\\n- ${modifications.join('\\n- ')}`\r\n          : 'Aucune modification d√©tect√©e';\r\n      }\r\n\r\n      // Fonction pour formater la valeur (en tenant compte des valeurs null/undefined et autres types)\r\n      function formatValeur(val) {\r\n        if (val === null || val === undefined) {\r\n          return ''; // Retourne une cha√Æne vide si la valeur est null ou undefined\r\n        }\r\n\r\n        // Si la valeur est un bool√©en, on la transforme en cha√Æne de caract√®res\r\n        if (typeof val === 'boolean') {\r\n          return val ? 'Oui' : 'Non';\r\n        }\r\n\r\n        // Si la valeur est un nombre, on retourne son formatage\r\n        if (typeof val === 'number') {\r\n          return val.toString();\r\n        }\r\n\r\n        // Pour les autres types de valeurs (cha√Ænes, objets, tableaux, etc.), on retourne la valeur sous forme de cha√Æne\r\n        return val.toString();\r\n      }\r\n\r\n\r\n\r\n      // G√âN√âRATION DU DETAIL_ACTION AVANC√â\r\n      const detail_action = genererDetailAction(ancienRapport, formData);\r\n\r\n      console.log('detail_action:', detail_action);\r\n      await axios.post(`${API}/rapports/historique`, {\r\n        id_rapport: id,\r\n        id_operateur: authData.Opid,\r\n        type_action: 'Modification Rapport',\r\n        date_action: new Date(new Date().getTime() + 2 * 60 * 60 * 1000).toISOString(),\r\n        detail_action\r\n      });\r\n\r\n      console.log('Rapport mis √† jour avec succ√®s:', response.data);\r\n      setSubmitStatus({ type: 'success', message: 'Rapport mis √† jour avec succ√®s!' });\r\n\r\n      setTimeout(() => {\r\n        navigate('/liste-rapports');\r\n      }, 2000);\r\n    } catch (error) {\r\n      console.error('Erreur lors de la mise √† jour du rapport:', error);\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: error.response?.data?.message || 'Une erreur est survenue lors de la mise √† jour du rapport.'\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n\r\n\r\n  if (loading) return (\r\n    <div className=\"loading-container\">\r\n      <div className=\"loading-spinner\"></div>\r\n      <p>Chargement des donn√©es du rapport...</p>\r\n    </div>\r\n  );\r\n\r\n  if (error) return (\r\n    <div className=\"error-container\">\r\n      <h2>Erreur</h2>\r\n      <p>{error}</p>\r\n      <button className=\"btn-primary\" onClick={() => navigate('/liste-rapports')}>\r\n        Retour √† la liste des rapports\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n\r\n  if (!accessChecked) {\r\n    return (\r\n      <div className=\"loading-container\">\r\n        <div className=\"loading-spinner\"></div>\r\n        <p>V√©rification des permissions...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!hasAccess) {\r\n    return (\r\n      <div className=\"error-container\">\r\n        <h2>Acc√®s refus√©</h2>\r\n\r\n        <p>Vous n'avez pas les droits pour modifier ce rapport.</p>\r\n        <br></br>\r\n        <button className=\"btn-primary\" onClick={() => navigate('/liste-rapports')}>\r\n          Retour √† la liste des rapports\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n\r\n\r\n  // Afficher le champ de d√©lai d'appareillage seulement si BSAA est coch√©\r\n  const showDelaiAppareillage = formData.bsaa;\r\n\r\n  return (\r\n\r\n\r\n\r\n    <div className=\"rapport-container\">\r\n\r\n\r\n      <div className=\"rapport-header\">\r\n        <h1 >Modifier Un rapport d'Evenement</h1>\r\n        <p className=\"rapport-subtitle\" style={{ fontSize: '0.9em', fontStyle: 'italic' }}>\r\n          Compl√©tez tous les champs obligatoires (*) pour soumettre un nouveau rapport\r\n        </p>\r\n      </div>\r\n\r\n\r\n\r\n      <form className=\"rapport-form\" onSubmit={handleSubmit}>\r\n        {/* Section Informations G√©n√©rales */}\r\n        <div className=\"form-section\">\r\n          <h2>Informations G√©n√©rales</h2>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"titre\">\r\n              Titre du rapport *\r\n              <span className=\"tooltip-icon\" title=\"Donnez un titre court et descriptif\">‚ÑπÔ∏è</span>\r\n            </label>\r\n            <input\r\n              id=\"titre\"\r\n              type=\"text\"\r\n              name=\"titre\"\r\n              value={formData.titre}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n              placeholder=\"Ex: Incident de d√©versement dans le secteur nord\"\r\n              required\r\n              maxLength=\"200\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"date_evenement\">\r\n                Date de l'√©v√©nement *\r\n                <span className=\"tooltip-icon\" title=\"Date √† laquelle l'√©v√©nement s'est produit\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"date_evenement\"\r\n                type=\"date\"\r\n                name=\"date_evenement\"\r\n                value={formData.date_evenement}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"heure_evenement\">\r\n                Heure de l'√©v√©nement *\r\n                <span className=\"tooltip-icon\" title=\"Heure √† laquelle l'√©v√©nement s'est produit\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"heure_evenement\"\r\n                type=\"time\"\r\n                name=\"heure_evenement\"\r\n                value={formData.heure_evenement}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                required\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section Classification de l'√âv√©nement */}\r\n        <div className=\"form-section\">\r\n          <h2>Classification de l'√âv√©nement</h2>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"id_type_evenement\">\r\n                Type d'√©v√©nement *\r\n                <span className=\"tooltip-icon\" title=\"Cat√©gorie principale de l'√©v√©nement\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <select\r\n                id=\"id_type_evenement\"\r\n                name=\"id_type_evenement\"\r\n                value={formData.id_type_evenement}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                required\r\n              >\r\n                <option value=\"\">-- S√©lectionner --</option>\r\n                {typesEvenement.map(type => (\r\n                  <option key={type.id_type_evenement} value={type.id_type_evenement}>\r\n                    {type.libelle}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"id_sous_type_evenement\">\r\n                Pr√©cision du type d'√©v√©nement\r\n                <span className=\"tooltip-icon\" title=\"Sp√©cification du type d'√©v√©nement\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <select\r\n                id=\"id_sous_type_evenement\"\r\n                name=\"id_sous_type_evenement\"\r\n                value={formData.id_sous_type_evenement}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                disabled={!formData.id_type_evenement}\r\n              >\r\n                <option value=\"\">-- S√©lectionner --</option>\r\n                {filteredSousTypes.map(sousType => (\r\n                  <option key={sousType.id_sous_type_evenement} value={sousType.id_sous_type_evenement}>\r\n                    {sousType.libelle}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"id_origine_evenement\">\r\n              Origine de l'√©v√©nement\r\n              <span className=\"tooltip-icon\" title=\"Source ou cause de l'√©v√©nement\">‚ÑπÔ∏è</span>\r\n            </label>\r\n            <select\r\n              id=\"id_origine_evenement\"\r\n              name=\"id_origine_evenement\"\r\n              value={formData.id_origine_evenement}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n            >\r\n              <option value=\"\">-- S√©lectionner --</option>\r\n              {originesEvenement.map(origine => (\r\n                <option key={origine.id_origine_evenement} value={origine.id_origine_evenement}>\r\n                  {origine.libelle}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section pour la cible */}\r\n        <div className=\"form-section\">\r\n          <h2>Cible de l'√âv√©nement</h2>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"libelle\">\r\n              Type de cible\r\n              <span className=\"tooltip-icon\" title=\"Type d'objet ou entit√© cibl√© par l'√©v√©nement\">‚ÑπÔ∏è</span>\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"libelle\"\r\n              name=\"libelle\"\r\n              value={formData.libelle}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n              placeholder=\"Ex: Navire, Installation, etc.\"\r\n            >\r\n            </input>\r\n          </div>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"nom_cible\">\r\n                Nom de la cible\r\n                <span className=\"tooltip-icon\" title=\"Nom du navire, de l'installation, etc.\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"nom_cible\"\r\n                type=\"text\"\r\n                name=\"nom_cible\"\r\n                value={formData.nom_cible}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: Navire Cargo XYZ\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"pavillon_cible\">\r\n                Pavillon\r\n                <span className=\"tooltip-icon\" title=\"Pays d'enregistrement (pour navires)\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"pavillon_cible\"\r\n                type=\"text\"\r\n                name=\"pavillon_cible\"\r\n                value={formData.pavillon_cible}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: France\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"immatriculation\">\r\n                Immatriculation\r\n                <span className=\"tooltip-icon\" title=\"MMSI/IMO Info immatriculation\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"immatriculation\"\r\n                type=\"text\"\r\n                name=\"immatriculation\"\r\n                value={formData.immatriculation}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: MMSI/IMO Info immatriculation\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"TypeProduit\">\r\n                Type Produit\r\n                <span className=\"tooltip-icon\" title=\"Type Produit\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"TypeProduit\"\r\n                type=\"text\"\r\n                name=\"TypeProduit\"\r\n                value={formData.TypeProduit}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: fioul lourd, Huile, etc.\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"QuantiteProduit\">\r\n                Quantite Produit\r\n                <span className=\"tooltip-icon\" title=\"Quantite de Produit\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"QuantiteProduit\"\r\n                type=\"text\"\r\n                name=\"QuantiteProduit\"\r\n                value={formData.QuantiteProduit}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: 1000L, 1000T, etc.\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        {/* Section pour la localisation */}\r\n        <div className=\"form-section\">\r\n          <h2>Localisation de l'√âv√©nement</h2>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"id_zone\">\r\n              Zone g√©ographique *\r\n              <span className=\"tooltip-icon\" title=\"Mer ou zone maritime o√π s'est produit l'√©v√©nement\">‚ÑπÔ∏è</span>\r\n            </label>\r\n            <select\r\n              id=\"id_zone\"\r\n              name=\"id_zone\"\r\n              value={formData.id_zone}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n              required\r\n            >\r\n              <option value=\"\">-- S√©lectionner une zone --</option>\r\n              {zonesGeographiques.map(zone => (\r\n                <option key={zone.id_zone} value={zone.id_zone}>\r\n                  {zone.nom_zone}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"details_lieu\">\r\n              Pr√©cision sur le lieu\r\n              <span className=\"tooltip-icon\" title=\"Description pr√©cise de l'emplacement\">‚ÑπÔ∏è</span>\r\n            </label>\r\n            <textarea\r\n              id=\"details_lieu\"\r\n              name=\"details_lieu\"\r\n              value={formData.details_lieu}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n              placeholder=\"D√©crivez l'emplacement pr√©cis (ex: 2 milles nautiques au sud du port de...\"\r\n              rows=\"3\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"latitude\">\r\n                Latitude\r\n                <span className=\"tooltip-icon\" title=\"Format d√©cimal (ex: 43.296398)\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"latitude\"\r\n                type=\"text\"\r\n                name=\"latitude\"\r\n                value={formData.latitude}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: 43.296398\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"longitude\">\r\n                Longitude\r\n                <span className=\"tooltip-icon\" title=\"Format d√©cimal (ex: 5.369779)\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"longitude\"\r\n                type=\"text\"\r\n                name=\"longitude\"\r\n                value={formData.longitude}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                placeholder=\"Ex: 5.369779\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"map-container\">\r\n            <label>S√©lectionnez un point sur la carte (cliquez pour d√©finir les coordonn√©es)</label>\r\n            <div\r\n              ref={mapRef}\r\n              id=\"map\"\r\n              className=\"location-map\"\r\n              style={{ height: '300px', width: '100%', marginTop: '10px' }}\r\n            >\r\n              {!mapInitialized && <div className=\"map-loading\">Chargement de la carte...</div>}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section pour les conditions m√©t√©orologiques */}\r\n        <div className=\"form-section\">\r\n          <h2>Conditions M√©t√©orologiques</h2>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"direction_vent\">\r\n                Direction du vent\r\n                <span className=\"tooltip-icon\" title=\"Direction d'o√π vient le vent\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <select\r\n                id=\"direction_vent\"\r\n                name=\"direction_vent\"\r\n                value={formData.direction_vent}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n              >\r\n                <option value=\"\">-- S√©lectionner --</option>\r\n                <option value=\"N\">Nord (N)</option>\r\n                <option value=\"NE\">Nord-Est (NE)</option>\r\n                <option value=\"E\">Est (E)</option>\r\n                <option value=\"SE\">Sud-Est (SE)</option>\r\n                <option value=\"S\">Sud (S)</option>\r\n                <option value=\"SO\">Sud-Ouest (SO)</option>\r\n                <option value=\"O\">Ouest (O)</option>\r\n                <option value=\"NO\">Nord-Ouest (NO)</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"maree\">\r\n                Mar√©e\r\n                <span className=\"tooltip-icon\" title=\"√âtat actuel de la mar√©e (observation au moment du rapport)\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <select\r\n                id=\"maree\"\r\n                name=\"maree\"\r\n                value={formData.maree}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n              >\r\n                <option value=\"\">-- S√©lectionner --</option>\r\n                <option value=\"haute\">Haute mer</option>\r\n                <option value=\"basse\">Basse mer</option>\r\n                <option value=\"montante\">Mar√©e montante</option>\r\n                <option value=\"descendante\">Mar√©e descendante</option>\r\n              </select>\r\n            </div>\r\n\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"force_vent\">\r\n                Force du vent (0-12)\r\n                <span className=\"tooltip-icon\" title=\"√âchelle de Beaufort de 0 √† 12\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                id=\"force_vent\"\r\n                name=\"force_vent\"\r\n                min=\"0\"\r\n                max=\"12\"\r\n                value={formData.force_vent}\r\n                onChange={handleChange}\r\n                className=\"form-control-range\"\r\n              />\r\n              <div className=\"range-value\">{formData.force_vent || '0'}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"etat_mer\">\r\n                √âtat de la mer (0-9)\r\n                <span className=\"tooltip-icon\" title=\"√âchelle de Douglas de 0 √† 9\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                id=\"etat_mer\"\r\n                name=\"etat_mer\"\r\n                min=\"0\"\r\n                max=\"9\"\r\n                value={formData.etat_mer}\r\n                onChange={handleChange}\r\n                className=\"form-control-range\"\r\n              />\r\n              <div className=\"range-value\">{formData.etat_mer || '0'}</div>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"nebulosite\">\r\n                N√©bulosit√© (0-9)\r\n                <span className=\"tooltip-icon\" title=\"√âchelle de couverture nuageuse de 0 √† 9\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                id=\"nebulosite\"\r\n                name=\"nebulosite\"\r\n                min=\"0\"\r\n                max=\"9\"\r\n                value={formData.nebulosite}\r\n                onChange={handleChange}\r\n                className=\"form-control-range\"\r\n              />\r\n              <div className=\"range-value\">{formData.nebulosite || '0'}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section pour les contacts et alertes */}\r\n        <div className=\"form-section\">\r\n          <h2>Contacts et Alertes</h2>\r\n\r\n          <div className=\"checkbox-grid\">\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"cedre_alerte\"\r\n                type=\"checkbox\"\r\n                name=\"cedre_alerte\"\r\n                checked={formData.cedre_alerte}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"cedre_alerte\">CEDRE alert√©</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"cross_alerte\"\r\n                type=\"checkbox\"\r\n                name=\"cross_alerte\"\r\n                checked={formData.cross_alerte}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"cross_alerte\">CROSS alert√©</label>\r\n            </div>\r\n\r\n\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"photo\"\r\n                type=\"checkbox\"\r\n                name=\"photo\"\r\n                checked={formData.photo}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"photo\">Photo</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"message_polrep\"\r\n                type=\"checkbox\"\r\n                name=\"message_polrep\"\r\n                checked={formData.message_polrep}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"message_polrep\">POLREP</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"derive_mothy\"\r\n                type=\"checkbox\"\r\n                name=\"derive_mothy\"\r\n                checked={formData.derive_mothy}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"derive_mothy\">D√©rive MOTHY</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"polmar_terre\"\r\n                type=\"checkbox\"\r\n                name=\"polmar_terre\"\r\n                checked={formData.polmar_terre}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"polmar_terre\">POLMAR Terre</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"smp\"\r\n                type=\"checkbox\"\r\n                name=\"smp\"\r\n                checked={formData.smp}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"smp\">SMP</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"sensible_proximite\"\r\n                type=\"checkbox\"\r\n                name=\"sensible_proximite\"\r\n                checked={formData.sensible_proximite}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"sensible_proximite\">Site sensible √† proximit√©</label>\r\n            </div>\r\n\r\n            <div className=\"checkbox-item\">\r\n              <input\r\n                id=\"bsaa\"\r\n                type=\"checkbox\"\r\n                name=\"bsaa\"\r\n                checked={formData.bsaa}\r\n                onChange={handleChange}\r\n              />\r\n              <label htmlFor=\"bsaa\">BSAA</label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Afficher le d√©lai d'appareillage seulement si BSAA est coch√© */}\r\n          {showDelaiAppareillage && (\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"delai_appareillage\">\r\n                D√©lai d'appareillage\r\n                <span className=\"tooltip-icon\" title=\"Date et heure d'appareillage pour BSAA\">‚ÑπÔ∏è</span>\r\n              </label>\r\n              <input\r\n                id=\"delai_appareillage\"\r\n                type=\"datetime-local\"\r\n                name=\"delai_appareillage\"\r\n                value={formData.delai_appareillage}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n              />\r\n            </div>\r\n          )}\r\n          <br></br>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"moyen_proximite\">Moyens √† proximit√©</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"moyen_proximite\"\r\n                name=\"moyen_proximite\"\r\n                value={formData.moyen_proximite}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"moyen_depeche\">Moyens d√©p√™ch√©s sur zone</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"moyen_depeche\"\r\n                name=\"moyen_depeche\"\r\n                value={formData.moyen_depeche}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"moyen_marine_etat\">Moyens maritimes ou de l‚Äô√âtat</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"moyen_marine_etat\"\r\n              name=\"moyen_marine_etat\"\r\n              value={formData.moyen_marine_etat}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n\r\n            />\r\n          </div>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"risque_court_terme\">Risque pr√©visible √† court terme</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"risque_court_terme\"\r\n                name=\"risque_court_terme\"\r\n                value={formData.risque_court_terme}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                rows={3}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"risque_moyen_long_terme\">\r\n                Risque pr√©visible √† moyen et long terme\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"risque_moyen_long_terme\"\r\n                name=\"risque_moyen_long_terme\"\r\n                value={formData.risque_moyen_long_terme}\r\n                onChange={handleChange}\r\n                className=\"form-control\"\r\n                rows={3}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        {/* Section Description D√©taill√©e */}\r\n        <div className=\"form-section\">\r\n          <h2>Description D√©taill√©e</h2>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"description_globale\">\r\n              Description globale de l'√©v√©nement *\r\n              <span className=\"tooltip-icon\" title=\"D√©crivez en d√©tail ce qui s'est pass√©\">‚ÑπÔ∏è</span>\r\n            </label>\r\n            <textarea\r\n              id=\"description_globale\"\r\n              name=\"description_globale\"\r\n              value={formData.description_globale}\r\n              onChange={handleChange}\r\n              className=\"form-control\"\r\n              placeholder=\"D√©crivez l'√©v√©nement de mani√®re d√©taill√©e : que s'est-il pass√©, o√π, quand, comment...\"\r\n              required\r\n              rows=\"6\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Boutons d'action */}\r\n        <div className=\"form-actions\">\r\n\r\n          <button\r\n            type=\"submit\"\r\n            className={`btn-primary ${isSubmitting ? 'loading' : ''}`}\r\n            disabled={isSubmitting}\r\n          >\r\n            {isSubmitting ? 'Modification ...' : 'Modifier le rapport'}\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"form-actions\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn-secondary\"\r\n            onClick={handleArchiver}\r\n            style={{ backgroundColor: '#a00', color: 'white', padding: '10px 20px', fontSize: '1rem', marginTop: '1rem' }}\r\n          >\r\n            üóÉÔ∏è Archiver ce rapport\r\n          </button>\r\n        </div>\r\n      </form>\r\n      <br></br>\r\n      {submitStatus && (\r\n        <div className={`status-message ${submitStatus.type}`}>\r\n          {submitStatus.message}\r\n        </div>\r\n      )}\r\n    </div>\r\n\r\n  );\r\n\r\n};\r\n\r\nexport default ModifierRapport;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}