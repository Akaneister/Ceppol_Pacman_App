{"ast":null,"code":"var _jsxFileName = \"D:\\\\Stage\\\\MarineV3\\\\frontend\\\\src\\\\components\\\\pages\\\\AjouterRapport.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport axios from 'axios';\nimport '../css/AjouterRapport.css';\nimport 'leaflet/dist/leaflet.css';\nimport GeneralInfoSection from './AjouterRapport/GeneralInfoSection';\nimport ClassificationSection from './AjouterRapport/ClassificationSection';\nimport TargetSection from './AjouterRapport/TargetSection';\nimport LocalisationSection from './AjouterRapport/LocalisationSection';\nimport MeteoSection from './AjouterRapport/MeteoSection';\nimport AlertesSection from './AjouterRapport/AlertesSection';\nimport DescriptionSection from './AjouterRapport/DescriptionSection';\nimport FormActions from './AjouterRapport/FormActions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = process.env.REACT_APP_API_URL;\nconst AjouterRapport = () => {\n  _s();\n  const {\n    authData\n  } = useAuth();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submitStatus, setSubmitStatus] = useState(null);\n  const mapRef = useRef(null);\n  const leafletMapRef = useRef(null);\n  const [mapInitialized, setMapInitialized] = useState(false);\n  const [marker, setMarker] = useState(null);\n  const [formData, setFormData] = useState(() => {\n    // Get current date and time in local timezone\n    const now = new Date();\n\n    // Format date as YYYY-MM-DD for the date input\n    const formattedDate = now.toISOString().split('T')[0];\n\n    // Format time as HH:MM in local timezone for the time input\n    const hours = String(now.getHours()).padStart(2, '0');\n    const minutes = String(now.getMinutes()).padStart(2, '0');\n    const formattedTime = `${hours}:${minutes}`;\n    return {\n      titre: '',\n      date_evenement: formattedDate,\n      heure_evenement: formattedTime,\n      description_globale: '',\n      id_type_evenement: '',\n      id_sous_type_evenement: '',\n      id_origine_evenement: '',\n      // Champs pour la cible de l'√©v√©nement\n      libelle: '',\n      nom_cible: '',\n      pavillon_cible: '',\n      // Champs pour la localisation\n      id_zone: '',\n      details_lieu: '',\n      latitude: '',\n      longitude: '',\n      // Conditions m√©t√©orologiques\n      direction_vent: '',\n      force_vent: '',\n      etat_mer: '',\n      nebulosite: '',\n      maree: '',\n      // Contacts et alertes\n      cedre_alerte: false,\n      cross_alerte: false,\n      photo: false,\n      message_polrep: false,\n      derive_mothy: false,\n      polmar_terre: false,\n      smp: false,\n      bsaa: false,\n      sensible_proximite: false,\n      moyen_proximite: '',\n      risque_court_terme: '',\n      risque_moyen_long_terme: '',\n      moyen_marine_etat: '',\n      moyen_depeche: '',\n      delai_appareillage: ''\n    };\n  });\n\n  // √âtats pour les listes d√©roulantes\n  const [typesEvenement, setTypesEvenement] = useState([]);\n  const [sousTypesEvenement, setSousTypesEvenement] = useState([]);\n  const [originesEvenement, setOriginesEvenement] = useState([]);\n  // const [typesCible, setTypesCible] = useState([]); // SUPPRIM√â car inutilis√©\n  const [zonesGeographiques, setZonesGeographiques] = useState([]);\n  const [filteredSousTypes, setFilteredSousTypes] = useState([]);\n\n  // R√©cup√©ration des donn√©es pour les listes d√©roulantes\n  useEffect(() => {\n    const fetchOptionsData = async () => {\n      try {\n        const [typesRes, sousTypesRes, originesRes, zonesRes /*, typesCibleRes*/] = await Promise.all([axios.get(`${API}/rapports/type-evenement`), axios.get(`${API}/rapports/sous-type-pollution`), axios.get(`${API}/rapports/origine-evenement`), axios.get(`${API}/rapports/zone-geographique`)\n        // axios.get(`${API}/rapports/type-cible`) // SUPPRIM√â car inutilis√©\n        ]);\n        setTypesEvenement(typesRes.data);\n        setSousTypesEvenement(sousTypesRes.data);\n        setOriginesEvenement(originesRes.data);\n        setZonesGeographiques(zonesRes.data);\n        // setTypesCible(typesCibleRes.data); // SUPPRIM√â car inutilis√©\n      } catch (error) {\n        console.error('Erreur lors de la r√©cup√©ration des donn√©es:', error);\n      }\n    };\n    fetchOptionsData();\n  }, []);\n\n  // Initialisation de la carte Leaflet\n  useEffect(() => {\n    /**\r\n     * Initialise la carte Leaflet si ce n'est pas d√©j√† fait.\r\n     * Charge dynamiquement la librairie si n√©cessaire.\r\n     */\n    if (mapRef.current && !mapInitialized && typeof window !== 'undefined') {\n      // Charger Leaflet dynamiquement si absent\n      if (!window.L) {\n        const script = document.createElement('script');\n        script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n        script.integrity = 'sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=';\n        script.crossOrigin = '';\n\n        // Charger la feuille de style si absente\n        if (!document.querySelector('link[href*=\"leaflet.css\"]')) {\n          const link = document.createElement('link');\n          link.rel = 'stylesheet';\n          link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n          link.integrity = 'sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=';\n          link.crossOrigin = '';\n          document.head.appendChild(link);\n        }\n        script.onload = initMap;\n        document.head.appendChild(script);\n      } else {\n        initMap();\n      }\n    }\n\n    /**\r\n     * Fonction d'initialisation de la carte.\r\n     * Centre la carte, ajoute la couche OSM et g√®re le clic utilisateur.\r\n     */\n    function initMap() {\n      try {\n        console.log(\"üó∫Ô∏è Initialisation de la carte...\");\n        if (leafletMapRef.current) {\n          leafletMapRef.current.remove();\n        }\n        const defaultCenter = [48.3904, -4.4861];\n        leafletMapRef.current = window.L.map(mapRef.current).setView(defaultCenter, 10);\n        window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        }).addTo(leafletMapRef.current);\n\n        // Fonction pour activer le clic sur la carte\n        function enableMapClick() {\n          leafletMapRef.current.on('click', onMapClick);\n        }\n\n        // Fonction pour d√©sactiver le clic sur la carte\n        function disableMapClick() {\n          leafletMapRef.current.off('click', onMapClick);\n        }\n\n        // Gestion du clic sur la carte\n        const onMapClick = function (e) {\n          const {\n            lat,\n            lng\n          } = e.latlng;\n          setFormData(prev => ({\n            ...prev,\n            latitude: lat.toFixed(6),\n            longitude: lng.toFixed(6)\n          }));\n\n          // Ajout ou d√©placement du marqueur\n          if (marker) {\n            marker.setLatLng([lat, lng]);\n          } else {\n            const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\n            setMarker(newMarker);\n\n            // Ajoute un gestionnaire de clic sur le marqueur pour le supprimer\n            newMarker.on('click', function () {\n              leafletMapRef.current.removeLayer(newMarker);\n              setMarker(null);\n              setFormData(prev => ({\n                ...prev,\n                latitude: '',\n                longitude: ''\n              }));\n              enableMapClick(); // R√©active le clic sur la carte\n            });\n          }\n          disableMapClick(); // D√©sactive le clic sur la carte apr√®s s√©lection\n          console.log(`Position s√©lectionn√©e: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\n        };\n        enableMapClick();\n        setTimeout(() => {\n          if (leafletMapRef.current) {\n            leafletMapRef.current.invalidateSize();\n          }\n        }, 200);\n        setMapInitialized(true);\n        console.log(\"‚úÖ Carte initialis√©e avec succ√®s\");\n      } catch (error) {\n        console.error('Erreur lors de l\\'initialisation de la carte:', error);\n      }\n    }\n\n    // Nettoyage de la carte au d√©montage du composant\n    return () => {\n      if (leafletMapRef.current) {\n        leafletMapRef.current.remove();\n        leafletMapRef.current = null;\n      }\n    };\n  }, []); // D√©pendances vides : ex√©cution une seule fois au montage\n\n  // Mettre √† jour la carte si les coordonn√©es sont modifi√©es manuellement\n  useEffect(() => {\n    if (mapInitialized && leafletMapRef.current && formData.latitude && formData.longitude) {\n      const lat = parseFloat(formData.latitude);\n      const lng = parseFloat(formData.longitude);\n      if (!isNaN(lat) && !isNaN(lng)) {\n        // Centre la carte sur les coordonn√©es saisies\n        leafletMapRef.current.setView([lat, lng], 12);\n\n        // Ajoute ou d√©place le marqueur\n        if (marker) {\n          marker.setLatLng([lat, lng]);\n        } else {\n          const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\n          setMarker(newMarker);\n        }\n      }\n    }\n  }, [formData.latitude, formData.longitude, mapInitialized, marker]); // Ajout de mapInitialized et marker\n\n  // Filtrer les sous-types en fonction du type s√©lectionn√©\n  useEffect(() => {\n    if (formData.id_type_evenement) {\n      const filtered = sousTypesEvenement.filter(sousType => sousType.id_type_evenement === parseInt(formData.id_type_evenement));\n      setFilteredSousTypes(filtered);\n      // R√©initialiser le sous-type s√©lectionn√© si le type change\n      if (!filtered.find(st => st.id_sous_type_evenement === parseInt(formData.id_sous_type_evenement))) {\n        setFormData(prev => ({\n          ...prev,\n          id_sous_type_evenement: ''\n        }));\n      }\n    } else {\n      setFilteredSousTypes([]);\n      setFormData(prev => ({\n        ...prev,\n        id_sous_type_evenement: ''\n      }));\n    }\n  }, [formData.id_type_evenement, sousTypesEvenement, formData.id_sous_type_evenement]); // Ajout de formData.id_sous_type_evenement\n\n  // Afficher le champ de d√©lai d'appareillage seulement si BSAA est coch√©\n  //const showDelaiAppareillage = formData.bsaa;\n\n  // G√©rer les changements dans le formulaire\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      type,\n      checked\n    } = e.target;\n\n    // Pour les checkboxes, utiliser la valeur de \"checked\" au lieu de \"value\"\n    const newValue = type === 'checkbox' ? checked : value;\n    setFormData(prev => ({\n      ...prev,\n      [name]: newValue\n    }));\n  };\n\n  // Valider le formulaire avant soumission\n  const validateForm = () => {\n    // V√©rifier les champs obligatoires\n    if (!formData.titre || !formData.date_evenement || !formData.heure_evenement || !formData.id_type_evenement || !formData.description_globale || !formData.id_zone) {\n      setSubmitStatus({\n        type: 'error',\n        message: 'Veuillez remplir tous les champs obligatoires (marqu√©s par *).'\n      });\n      return false;\n    }\n    return true;\n  };\n\n  // Fonction pour g√©rer l'envoi du formulaire\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    // Valider le formulaire\n    if (!validateForm()) {\n      return;\n    }\n    setIsSubmitting(true);\n    setSubmitStatus(null);\n    try {\n      // Combiner la date et l'heure pour le backend\n      //const dateTimeString = `${formData.date_evenement}T${formData.heure_evenement}:00`;\n\n      // Cr√©er une date locale\n      const localDate = new Date(`${formData.date_evenement}T${formData.heure_evenement}:00`);\n\n      // Convertir en UTC et formatter au format ISO\n      const dateTimeUTC = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString();\n      const rapport = {\n        titre: formData.titre,\n        date_evenement: dateTimeUTC,\n        description_globale: formData.description_globale,\n        id_operateur: authData.Opid,\n        id_type_evenement: formData.id_type_evenement ? parseInt(formData.id_type_evenement) : null,\n        id_sous_type_evenement: formData.id_sous_type_evenement ? parseInt(formData.id_sous_type_evenement) : null,\n        id_origine_evenement: formData.id_origine_evenement ? parseInt(formData.id_origine_evenement) : null\n      };\n\n      // Donn√©es associ√©es pour les tables connexes\n      const metaData = {\n        cible: {\n          libelle: formData.libelle || null,\n          nom_cible: formData.nom_cible || null,\n          pavillon_cible: formData.pavillon_cible || null,\n          immatriculation: formData.immatriculation || null,\n          QuantiteProduit: formData.QuantiteProduit || null,\n          TypeProduit: formData.TypeProduit || null\n        },\n        localisation: {\n          id_zone: formData.id_zone ? parseInt(formData.id_zone) : null,\n          details_lieu: formData.details_lieu || null,\n          latitude: formData.latitude ? parseFloat(formData.latitude) : null,\n          longitude: formData.longitude ? parseFloat(formData.longitude) : null\n        },\n        meteo: {\n          direction_vent: formData.direction_vent || null,\n          force_vent: formData.force_vent ? parseInt(formData.force_vent) : null,\n          etat_mer: formData.etat_mer ? parseInt(formData.etat_mer) : null,\n          nebulosite: formData.nebulosite ? parseInt(formData.nebulosite) : null,\n          maree: formData.maree || null\n        },\n        alertes: {\n          cedre_alerte: formData.cedre_alerte ? 1 : 0,\n          cross_alerte: formData.cross_alerte ? 1 : 0,\n          photo: formData.photo ? 1 : 0,\n          message_polrep: formData.message_polrep ? 1 : 0,\n          derive_mothy: formData.derive_mothy ? 1 : 0,\n          polmar_terre: formData.polmar_terre ? 1 : 0,\n          smp: formData.smp ? 1 : 0,\n          bsaa: formData.bsaa ? 1 : 0,\n          sensible_proximite: formData.sensible_proximite ? 1 : 0,\n          delai_appareillage: formData.delai_appareillage || null,\n          moyen_proximite: formData.moyen_proximite || null,\n          risque_court_terme: formData.risque_court_terme || null,\n          risque_moyen_long_terme: formData.risque_moyen_long_terme || null,\n          moyen_depeche: formData.moyen_depeche || null,\n          moyen_marine_etat: formData.moyen_marine_etat || null\n        }\n      };\n      console.log(\"Donn√©es envoy√©es au backend:\", {\n        rapport,\n        metaData\n      });\n\n      // Envoi des donn√©es au backend\n      const response = await axios.post(`${API}/rapports`, {\n        rapport,\n        metaData\n      });\n      console.log('Rapport cr√©√© avec succ√®s:', response.data);\n      setSubmitStatus({\n        type: 'success',\n        message: 'Rapport enregistr√© avec succ√®s!'\n      });\n\n      // R√©initialisation du formulaire apr√®s succ√®s\n      resetForm();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Erreur lors de la cr√©ation du rapport:', error);\n      setSubmitStatus({\n        type: 'error',\n        message: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Une erreur est survenue lors de l\\'enregistrement du rapport.'\n      });\n    } finally {\n      setIsSubmitting(false);\n\n      // Effacer le message de statut apr√®s 5 secondes si c'est un succ√®s\n      if ((submitStatus === null || submitStatus === void 0 ? void 0 : submitStatus.type) === 'success') {\n        setTimeout(() => {\n          setSubmitStatus(null);\n        }, 5000);\n      }\n    }\n  };\n\n  // Fonction pour r√©initialiser le formulaire\n  const resetForm = () => {\n    setFormData({\n      titre: '',\n      date_evenement: new Date().toISOString().split('T')[0],\n      heure_evenement: new Date().toISOString().split('T')[1].substring(0, 5),\n      description_globale: '',\n      id_type_evenement: '',\n      id_sous_type_evenement: '',\n      id_origine_evenement: '',\n      libelle: '',\n      nom_cible: '',\n      pavillon_cible: '',\n      id_zone: '',\n      details_lieu: '',\n      latitude: '',\n      longitude: '',\n      direction_vent: '',\n      force_vent: '',\n      etat_mer: '',\n      nebulosite: '',\n      maree: '',\n      cedre_alerte: false,\n      cross_alerte: false,\n      photo: false,\n      message_polrep: false,\n      derive_mothy: false,\n      polmar_terre: false,\n      smp: false,\n      bsaa: false,\n      sensible_proximite: false,\n      moyen_proximite: '',\n      risque_court_terme: '',\n      risque_moyen_long_terme: '',\n      moyen_marine_etat: '',\n      moyen_depeche: '',\n      delai_appareillage: '',\n      immatriculation: '',\n      QuantiteProduit: '',\n      TypeProduit: ''\n    });\n\n    // Supprimer le marqueur de la carte\n    if (marker && leafletMapRef.current) {\n      leafletMapRef.current.removeLayer(marker);\n      setMarker(null);\n    }\n\n    // Recentrer la carte\n    if (leafletMapRef.current) {\n      leafletMapRef.current.setView([48.3904, -4.4861], 10);\n    }\n  };\n\n  // Reste du code (rendu du formulaire)...\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"rapport-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rapport-header\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"rapport-subtitle\",\n        style: {\n          fontSize: '0.9em',\n          fontStyle: 'italic'\n        },\n        children: \"Compl\\xE9tez tous les champs obligatoires (*) pour soumettre un nouveau rapport\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 476,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"rapport-form\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(GeneralInfoSection, {\n        formData: formData,\n        handleChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ClassificationSection, {\n        formData: formData,\n        handleChange: handleChange,\n        typesEvenement: typesEvenement,\n        filteredSousTypes: filteredSousTypes,\n        originesEvenement: originesEvenement\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TargetSection, {\n        formData: formData,\n        handleChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(LocalisationSection, {\n        formData: formData,\n        handleChange: handleChange,\n        mapRef: mapRef,\n        mapInitialized: mapInitialized,\n        zonesGeographiques: zonesGeographiques\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MeteoSection, {\n        formData: formData,\n        handleChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AlertesSection, {\n        formData: formData,\n        handleChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DescriptionSection, {\n        formData: formData,\n        handleChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FormActions, {\n        isSubmitting: isSubmitting,\n        handleSubmit: handleSubmit,\n        resetForm: resetForm\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 7\n    }, this), submitStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `status-message ${submitStatus.type}`,\n      children: submitStatus.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 513,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 473,\n    columnNumber: 5\n  }, this);\n};\n_s(AjouterRapport, \"C9wvADh9CWLRzxd232cRAxfX4wM=\", false, function () {\n  return [useAuth];\n});\n_c = AjouterRapport;\nexport default AjouterRapport;\nvar _c;\n$RefreshReg$(_c, \"AjouterRapport\");","map":{"version":3,"names":["useState","useEffect","useRef","useAuth","axios","GeneralInfoSection","ClassificationSection","TargetSection","LocalisationSection","MeteoSection","AlertesSection","DescriptionSection","FormActions","jsxDEV","_jsxDEV","API","process","env","REACT_APP_API_URL","AjouterRapport","_s","authData","isSubmitting","setIsSubmitting","submitStatus","setSubmitStatus","mapRef","leafletMapRef","mapInitialized","setMapInitialized","marker","setMarker","formData","setFormData","now","Date","formattedDate","toISOString","split","hours","String","getHours","padStart","minutes","getMinutes","formattedTime","titre","date_evenement","heure_evenement","description_globale","id_type_evenement","id_sous_type_evenement","id_origine_evenement","libelle","nom_cible","pavillon_cible","id_zone","details_lieu","latitude","longitude","direction_vent","force_vent","etat_mer","nebulosite","maree","cedre_alerte","cross_alerte","photo","message_polrep","derive_mothy","polmar_terre","smp","bsaa","sensible_proximite","moyen_proximite","risque_court_terme","risque_moyen_long_terme","moyen_marine_etat","moyen_depeche","delai_appareillage","typesEvenement","setTypesEvenement","sousTypesEvenement","setSousTypesEvenement","originesEvenement","setOriginesEvenement","zonesGeographiques","setZonesGeographiques","filteredSousTypes","setFilteredSousTypes","fetchOptionsData","typesRes","sousTypesRes","originesRes","zonesRes","Promise","all","get","data","error","console","current","window","L","script","document","createElement","src","integrity","crossOrigin","querySelector","link","rel","href","head","appendChild","onload","initMap","log","remove","defaultCenter","map","setView","tileLayer","attribution","addTo","enableMapClick","on","onMapClick","disableMapClick","off","e","lat","lng","latlng","prev","toFixed","setLatLng","newMarker","removeLayer","setTimeout","invalidateSize","parseFloat","isNaN","filtered","filter","sousType","parseInt","find","st","handleChange","name","value","type","checked","target","newValue","validateForm","message","handleSubmit","preventDefault","localDate","dateTimeUTC","getTime","getTimezoneOffset","rapport","id_operateur","Opid","metaData","cible","immatriculation","QuantiteProduit","TypeProduit","localisation","meteo","alertes","response","post","resetForm","_error$response","_error$response$data","substring","className","children","style","fontSize","fontStyle","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","_c","$RefreshReg$"],"sources":["D:/Stage/MarineV3/frontend/src/components/pages/AjouterRapport.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport axios from 'axios';\r\nimport '../css/AjouterRapport.css';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n\r\nimport GeneralInfoSection from './AjouterRapport/GeneralInfoSection';\r\nimport ClassificationSection from './AjouterRapport/ClassificationSection';\r\nimport TargetSection from './AjouterRapport/TargetSection';\r\nimport LocalisationSection from './AjouterRapport/LocalisationSection';\r\nimport MeteoSection from './AjouterRapport/MeteoSection';\r\nimport AlertesSection from './AjouterRapport/AlertesSection';\r\nimport DescriptionSection from './AjouterRapport/DescriptionSection';\r\nimport FormActions from './AjouterRapport/FormActions';\r\n\r\n\r\nconst API = process.env.REACT_APP_API_URL;\r\n\r\nconst AjouterRapport = () => {\r\n  const { authData } = useAuth();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [submitStatus, setSubmitStatus] = useState(null);\r\n  const mapRef = useRef(null);\r\n  const leafletMapRef = useRef(null);\r\n  const [mapInitialized, setMapInitialized] = useState(false);\r\n  const [marker, setMarker] = useState(null);\r\n\r\n  const [formData, setFormData] = useState(() => {\r\n    // Get current date and time in local timezone\r\n    const now = new Date();\r\n\r\n    // Format date as YYYY-MM-DD for the date input\r\n    const formattedDate = now.toISOString().split('T')[0];\r\n\r\n    // Format time as HH:MM in local timezone for the time input\r\n    const hours = String(now.getHours()).padStart(2, '0');\r\n    const minutes = String(now.getMinutes()).padStart(2, '0');\r\n    const formattedTime = `${hours}:${minutes}`;\r\n\r\n    return {\r\n      titre: '',\r\n      date_evenement: formattedDate,\r\n      heure_evenement: formattedTime,\r\n      description_globale: '',\r\n      id_type_evenement: '',\r\n      id_sous_type_evenement: '',\r\n      id_origine_evenement: '',\r\n      // Champs pour la cible de l'√©v√©nement\r\n      libelle: '',\r\n      nom_cible: '',\r\n      pavillon_cible: '',\r\n      // Champs pour la localisation\r\n      id_zone: '',\r\n      details_lieu: '',\r\n      latitude: '',\r\n      longitude: '',\r\n      // Conditions m√©t√©orologiques\r\n      direction_vent: '',\r\n      force_vent: '',\r\n      etat_mer: '',\r\n      nebulosite: '',\r\n      maree: '',\r\n      // Contacts et alertes\r\n      cedre_alerte: false,\r\n      cross_alerte: false,\r\n      photo: false,\r\n      message_polrep: false,\r\n      derive_mothy: false,\r\n      polmar_terre: false,\r\n      smp: false,\r\n      bsaa: false,\r\n      sensible_proximite: false,\r\n      moyen_proximite: '',\r\n      risque_court_terme: '',\r\n      risque_moyen_long_terme: '',\r\n      moyen_marine_etat: '',\r\n      moyen_depeche: '',\r\n      delai_appareillage: ''\r\n    };\r\n  });\r\n\r\n  // √âtats pour les listes d√©roulantes\r\n  const [typesEvenement, setTypesEvenement] = useState([]);\r\n  const [sousTypesEvenement, setSousTypesEvenement] = useState([]);\r\n  const [originesEvenement, setOriginesEvenement] = useState([]);\r\n  // const [typesCible, setTypesCible] = useState([]); // SUPPRIM√â car inutilis√©\r\n  const [zonesGeographiques, setZonesGeographiques] = useState([]);\r\n  const [filteredSousTypes, setFilteredSousTypes] = useState([]);\r\n\r\n  // R√©cup√©ration des donn√©es pour les listes d√©roulantes\r\n  useEffect(() => {\r\n    const fetchOptionsData = async () => {\r\n      try {\r\n        const [typesRes, sousTypesRes, originesRes, zonesRes/*, typesCibleRes*/] = await Promise.all([\r\n          axios.get(`${API}/rapports/type-evenement`),\r\n          axios.get(`${API}/rapports/sous-type-pollution`),\r\n          axios.get(`${API}/rapports/origine-evenement`),\r\n          axios.get(`${API}/rapports/zone-geographique`)\r\n          // axios.get(`${API}/rapports/type-cible`) // SUPPRIM√â car inutilis√©\r\n        ]);\r\n\r\n        setTypesEvenement(typesRes.data);\r\n        setSousTypesEvenement(sousTypesRes.data);\r\n        setOriginesEvenement(originesRes.data);\r\n        setZonesGeographiques(zonesRes.data);\r\n        // setTypesCible(typesCibleRes.data); // SUPPRIM√â car inutilis√©\r\n      } catch (error) {\r\n        console.error('Erreur lors de la r√©cup√©ration des donn√©es:', error);\r\n      }\r\n    };\r\n\r\n    fetchOptionsData();\r\n  }, []);\r\n\r\n  // Initialisation de la carte Leaflet\r\n  useEffect(() => {\r\n    /**\r\n     * Initialise la carte Leaflet si ce n'est pas d√©j√† fait.\r\n     * Charge dynamiquement la librairie si n√©cessaire.\r\n     */\r\n    if (mapRef.current && !mapInitialized && typeof window !== 'undefined') {\r\n      // Charger Leaflet dynamiquement si absent\r\n      if (!window.L) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\r\n        script.integrity = 'sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=';\r\n        script.crossOrigin = '';\r\n\r\n        // Charger la feuille de style si absente\r\n        if (!document.querySelector('link[href*=\"leaflet.css\"]')) {\r\n          const link = document.createElement('link');\r\n          link.rel = 'stylesheet';\r\n          link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\r\n          link.integrity = 'sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=';\r\n          link.crossOrigin = '';\r\n          document.head.appendChild(link);\r\n        }\r\n\r\n        script.onload = initMap;\r\n        document.head.appendChild(script);\r\n      } else {\r\n        initMap();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Fonction d'initialisation de la carte.\r\n     * Centre la carte, ajoute la couche OSM et g√®re le clic utilisateur.\r\n     */\r\n    function initMap() {\r\n      try {\r\n        console.log(\"üó∫Ô∏è Initialisation de la carte...\");\r\n\r\n        if (leafletMapRef.current) {\r\n          leafletMapRef.current.remove();\r\n        }\r\n\r\n        const defaultCenter = [48.3904, -4.4861];\r\n        leafletMapRef.current = window.L.map(mapRef.current).setView(defaultCenter, 10);\r\n\r\n        window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n        }).addTo(leafletMapRef.current);\r\n\r\n        // Fonction pour activer le clic sur la carte\r\n        function enableMapClick() {\r\n          leafletMapRef.current.on('click', onMapClick);\r\n        }\r\n\r\n        // Fonction pour d√©sactiver le clic sur la carte\r\n        function disableMapClick() {\r\n          leafletMapRef.current.off('click', onMapClick);\r\n        }\r\n\r\n        // Gestion du clic sur la carte\r\n        const onMapClick = function (e) {\r\n          const { lat, lng } = e.latlng;\r\n\r\n          setFormData(prev => ({\r\n            ...prev,\r\n            latitude: lat.toFixed(6),\r\n            longitude: lng.toFixed(6)\r\n          }));\r\n\r\n          // Ajout ou d√©placement du marqueur\r\n          if (marker) {\r\n            marker.setLatLng([lat, lng]);\r\n          } else {\r\n            const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\r\n            setMarker(newMarker);\r\n\r\n            // Ajoute un gestionnaire de clic sur le marqueur pour le supprimer\r\n            newMarker.on('click', function () {\r\n              leafletMapRef.current.removeLayer(newMarker);\r\n              setMarker(null);\r\n              setFormData(prev => ({\r\n                ...prev,\r\n                latitude: '',\r\n                longitude: ''\r\n              }));\r\n              enableMapClick(); // R√©active le clic sur la carte\r\n            });\r\n          }\r\n\r\n          disableMapClick(); // D√©sactive le clic sur la carte apr√®s s√©lection\r\n          console.log(`Position s√©lectionn√©e: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\r\n        };\r\n\r\n        enableMapClick();\r\n\r\n        setTimeout(() => {\r\n          if (leafletMapRef.current) {\r\n            leafletMapRef.current.invalidateSize();\r\n          }\r\n        }, 200);\r\n\r\n        setMapInitialized(true);\r\n        console.log(\"‚úÖ Carte initialis√©e avec succ√®s\");\r\n      } catch (error) {\r\n        console.error('Erreur lors de l\\'initialisation de la carte:', error);\r\n      }\r\n    }\r\n\r\n    // Nettoyage de la carte au d√©montage du composant\r\n    return () => {\r\n      if (leafletMapRef.current) {\r\n        leafletMapRef.current.remove();\r\n        leafletMapRef.current = null;\r\n      }\r\n    };\r\n  }, []); // D√©pendances vides : ex√©cution une seule fois au montage\r\n\r\n  // Mettre √† jour la carte si les coordonn√©es sont modifi√©es manuellement\r\n  useEffect(() => {\r\n    if (\r\n      mapInitialized &&\r\n      leafletMapRef.current &&\r\n      formData.latitude &&\r\n      formData.longitude\r\n    ) {\r\n      const lat = parseFloat(formData.latitude);\r\n      const lng = parseFloat(formData.longitude);\r\n\r\n      if (!isNaN(lat) && !isNaN(lng)) {\r\n        // Centre la carte sur les coordonn√©es saisies\r\n        leafletMapRef.current.setView([lat, lng], 12);\r\n\r\n        // Ajoute ou d√©place le marqueur\r\n        if (marker) {\r\n          marker.setLatLng([lat, lng]);\r\n        } else {\r\n          const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\r\n          setMarker(newMarker);\r\n        }\r\n      }\r\n    }\r\n  }, [formData.latitude, formData.longitude, mapInitialized, marker]); // Ajout de mapInitialized et marker\r\n\r\n  // Filtrer les sous-types en fonction du type s√©lectionn√©\r\n  useEffect(() => {\r\n    if (formData.id_type_evenement) {\r\n      const filtered = sousTypesEvenement.filter(\r\n        sousType => sousType.id_type_evenement === parseInt(formData.id_type_evenement)\r\n      );\r\n      setFilteredSousTypes(filtered);\r\n      // R√©initialiser le sous-type s√©lectionn√© si le type change\r\n      if (!filtered.find(st => st.id_sous_type_evenement === parseInt(formData.id_sous_type_evenement))) {\r\n        setFormData(prev => ({ ...prev, id_sous_type_evenement: '' }));\r\n      }\r\n    } else {\r\n      setFilteredSousTypes([]);\r\n      setFormData(prev => ({ ...prev, id_sous_type_evenement: '' }));\r\n    }\r\n  }, [formData.id_type_evenement, sousTypesEvenement, formData.id_sous_type_evenement]); // Ajout de formData.id_sous_type_evenement\r\n\r\n  // Afficher le champ de d√©lai d'appareillage seulement si BSAA est coch√©\r\n  //const showDelaiAppareillage = formData.bsaa;\r\n\r\n  // G√©rer les changements dans le formulaire\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n\r\n    // Pour les checkboxes, utiliser la valeur de \"checked\" au lieu de \"value\"\r\n    const newValue = type === 'checkbox' ? checked : value;\r\n\r\n    setFormData(prev => ({ ...prev, [name]: newValue }));\r\n  };\r\n\r\n  // Valider le formulaire avant soumission\r\n  const validateForm = () => {\r\n    // V√©rifier les champs obligatoires\r\n    if (!formData.titre || !formData.date_evenement || !formData.heure_evenement ||\r\n      !formData.id_type_evenement || !formData.description_globale || !formData.id_zone) {\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: 'Veuillez remplir tous les champs obligatoires (marqu√©s par *).'\r\n      });\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  // Fonction pour g√©rer l'envoi du formulaire\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Valider le formulaire\r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setSubmitStatus(null);\r\n\r\n    try {\r\n      // Combiner la date et l'heure pour le backend\r\n      //const dateTimeString = `${formData.date_evenement}T${formData.heure_evenement}:00`;\r\n\r\n      // Cr√©er une date locale\r\n      const localDate = new Date(`${formData.date_evenement}T${formData.heure_evenement}:00`);\r\n\r\n      // Convertir en UTC et formatter au format ISO\r\n      const dateTimeUTC = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString();\r\n\r\n\r\n\r\n\r\n\r\n      const rapport = {\r\n        titre: formData.titre,\r\n        date_evenement: dateTimeUTC,\r\n        description_globale: formData.description_globale,\r\n        id_operateur: authData.Opid,\r\n        id_type_evenement: formData.id_type_evenement ? parseInt(formData.id_type_evenement) : null,\r\n        id_sous_type_evenement: formData.id_sous_type_evenement ? parseInt(formData.id_sous_type_evenement) : null,\r\n        id_origine_evenement: formData.id_origine_evenement ? parseInt(formData.id_origine_evenement) : null,\r\n      };\r\n\r\n\r\n      // Donn√©es associ√©es pour les tables connexes\r\n      const metaData = {\r\n        cible: {\r\n          libelle: formData.libelle || null,\r\n          nom_cible: formData.nom_cible || null,\r\n          pavillon_cible: formData.pavillon_cible || null,\r\n          immatriculation: formData.immatriculation || null,\r\n          QuantiteProduit: formData.QuantiteProduit || null,\r\n          TypeProduit: formData.TypeProduit || null,\r\n        },\r\n        localisation: {\r\n          id_zone: formData.id_zone ? parseInt(formData.id_zone) : null,\r\n          details_lieu: formData.details_lieu || null,\r\n          latitude: formData.latitude ? parseFloat(formData.latitude) : null,\r\n          longitude: formData.longitude ? parseFloat(formData.longitude) : null,\r\n        },\r\n        meteo: {\r\n          direction_vent: formData.direction_vent || null,\r\n          force_vent: formData.force_vent ? parseInt(formData.force_vent) : null,\r\n          etat_mer: formData.etat_mer ? parseInt(formData.etat_mer) : null,\r\n          nebulosite: formData.nebulosite ? parseInt(formData.nebulosite) : null,\r\n          maree: formData.maree || null,\r\n        },\r\n        alertes: {\r\n          cedre_alerte: formData.cedre_alerte ? 1 : 0,\r\n          cross_alerte: formData.cross_alerte ? 1 : 0,\r\n          photo: formData.photo ? 1 : 0,\r\n          message_polrep: formData.message_polrep ? 1 : 0,\r\n          derive_mothy: formData.derive_mothy ? 1 : 0,\r\n          polmar_terre: formData.polmar_terre ? 1 : 0,\r\n          smp: formData.smp ? 1 : 0,\r\n          bsaa: formData.bsaa ? 1 : 0,\r\n          sensible_proximite: formData.sensible_proximite ? 1 : 0,\r\n          delai_appareillage: formData.delai_appareillage || null,\r\n          moyen_proximite: formData.moyen_proximite || null,\r\n          risque_court_terme: formData.risque_court_terme || null,\r\n          risque_moyen_long_terme: formData.risque_moyen_long_terme || null,\r\n          moyen_depeche: formData.moyen_depeche || null,\r\n          moyen_marine_etat: formData.moyen_marine_etat || null,\r\n        }\r\n      };\r\n\r\n      console.log(\"Donn√©es envoy√©es au backend:\", { rapport, metaData });\r\n\r\n      // Envoi des donn√©es au backend\r\n      const response = await axios.post(`${API}/rapports`, {\r\n        rapport,\r\n        metaData\r\n      });\r\n\r\n\r\n\r\n\r\n      console.log('Rapport cr√©√© avec succ√®s:', response.data);\r\n      setSubmitStatus({ type: 'success', message: 'Rapport enregistr√© avec succ√®s!' });\r\n\r\n      // R√©initialisation du formulaire apr√®s succ√®s\r\n      resetForm();\r\n    } catch (error) {\r\n      console.error('Erreur lors de la cr√©ation du rapport:', error);\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: error.response?.data?.message || 'Une erreur est survenue lors de l\\'enregistrement du rapport.'\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n\r\n      // Effacer le message de statut apr√®s 5 secondes si c'est un succ√®s\r\n      if (submitStatus?.type === 'success') {\r\n        setTimeout(() => {\r\n          setSubmitStatus(null);\r\n        }, 5000);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Fonction pour r√©initialiser le formulaire\r\n  const resetForm = () => {\r\n    setFormData({\r\n      titre: '',\r\n      date_evenement: new Date().toISOString().split('T')[0],\r\n      heure_evenement: new Date().toISOString().split('T')[1].substring(0, 5),\r\n      description_globale: '',\r\n      id_type_evenement: '',\r\n      id_sous_type_evenement: '',\r\n      id_origine_evenement: '',\r\n      libelle: '',\r\n      nom_cible: '',\r\n      pavillon_cible: '',\r\n      id_zone: '',\r\n      details_lieu: '',\r\n      latitude: '',\r\n      longitude: '',\r\n      direction_vent: '',\r\n      force_vent: '',\r\n      etat_mer: '',\r\n      nebulosite: '',\r\n      maree: '',\r\n      cedre_alerte: false,\r\n      cross_alerte: false,\r\n      photo: false,\r\n      message_polrep: false,\r\n      derive_mothy: false,\r\n      polmar_terre: false,\r\n      smp: false,\r\n      bsaa: false,\r\n      sensible_proximite: false,\r\n      moyen_proximite: '',\r\n      risque_court_terme: '',\r\n      risque_moyen_long_terme: '',\r\n      moyen_marine_etat: '',\r\n      moyen_depeche: '',\r\n      delai_appareillage: '',\r\n      immatriculation: '',\r\n      QuantiteProduit: '',\r\n      TypeProduit: ''\r\n    });\r\n\r\n    // Supprimer le marqueur de la carte\r\n    if (marker && leafletMapRef.current) {\r\n      leafletMapRef.current.removeLayer(marker);\r\n      setMarker(null);\r\n    }\r\n\r\n    // Recentrer la carte\r\n    if (leafletMapRef.current) {\r\n      leafletMapRef.current.setView([48.3904, -4.4861], 10);\r\n    }\r\n  };\r\n\r\n  // Reste du code (rendu du formulaire)...\r\n  return (\r\n    <div className=\"rapport-container\">\r\n\r\n\r\n      <div className=\"rapport-header\">\r\n        \r\n        <p className=\"rapport-subtitle\" style={{ fontSize: '0.9em', fontStyle: 'italic' }}>\r\n          Compl√©tez tous les champs obligatoires (*) pour soumettre un nouveau rapport\r\n        </p>\r\n      </div>\r\n\r\n\r\n\r\n      <form className=\"rapport-form\" onSubmit={handleSubmit}>\r\n        <GeneralInfoSection formData={formData} handleChange={handleChange} />\r\n        <ClassificationSection\r\n          formData={formData}\r\n          handleChange={handleChange}\r\n          typesEvenement={typesEvenement}\r\n          filteredSousTypes={filteredSousTypes}\r\n          originesEvenement={originesEvenement}\r\n        />\r\n        <TargetSection formData={formData} handleChange={handleChange} />\r\n        <LocalisationSection\r\n          formData={formData}\r\n          handleChange={handleChange}\r\n          mapRef={mapRef}\r\n          mapInitialized={mapInitialized}\r\n          zonesGeographiques={zonesGeographiques}\r\n        />\r\n        <MeteoSection formData={formData} handleChange={handleChange} />\r\n        <AlertesSection formData={formData} handleChange={handleChange} />\r\n        <DescriptionSection formData={formData} handleChange={handleChange} />\r\n        <FormActions\r\n          isSubmitting={isSubmitting}\r\n          handleSubmit={handleSubmit}\r\n          resetForm={resetForm}\r\n        />\r\n      </form>\r\n      <br></br>\r\n      {submitStatus && (\r\n        <div className={`status-message ${submitStatus.type}`}>\r\n          {submitStatus.message}\r\n        </div>\r\n      )}\r\n    </div>\r\n\r\n  );\r\n};\r\n\r\nexport default AjouterRapport;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}