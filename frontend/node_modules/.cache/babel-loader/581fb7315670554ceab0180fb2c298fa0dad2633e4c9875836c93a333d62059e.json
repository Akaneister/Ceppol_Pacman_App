{"ast":null,"code":"import{useState,useEffect,useRef}from'react';import{useAuth}from'../context/AuthContext';import axios from'axios';import'../css/AjouterRapport.css';import'leaflet/dist/leaflet.css';import GeneralInfoSection from'./AjouterRapport/GeneralInfoSection';import ClassificationSection from'./AjouterRapport/ClassificationSection';import TargetSection from'./AjouterRapport/TargetSection';import LocalisationSection from'./AjouterRapport/LocalisationSection';import MeteoSection from'./AjouterRapport/MeteoSection';import AlertesSection from'./AjouterRapport/AlertesSection';import DescriptionSection from'./AjouterRapport/DescriptionSection';import FormActions from'./AjouterRapport/FormActions';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=process.env.REACT_APP_API_URL;const AjouterRapport=()=>{const{authData}=useAuth();const[isSubmitting,setIsSubmitting]=useState(false);const[submitStatus,setSubmitStatus]=useState(null);const mapRef=useRef(null);const leafletMapRef=useRef(null);const[mapInitialized,setMapInitialized]=useState(false);const[marker,setMarker]=useState(null);const[formData,setFormData]=useState(()=>{// Get current date and time in local timezone\nconst now=new Date();// Format date as YYYY-MM-DD for the date input\nconst formattedDate=now.toISOString().split('T')[0];// Format time as HH:MM in local timezone for the time input\nconst hours=String(now.getHours()).padStart(2,'0');const minutes=String(now.getMinutes()).padStart(2,'0');const formattedTime=`${hours}:${minutes}`;return{titre:'',date_evenement:formattedDate,heure_evenement:formattedTime,description_globale:'',id_type_evenement:'',id_sous_type_evenement:'',id_origine_evenement:'',// Champs pour la cible de l'√©v√©nement\nlibelle:'',nom_cible:'',pavillon_cible:'',// Champs pour la localisation\nid_zone:'',details_lieu:'',latitude:'',longitude:'',// Conditions m√©t√©orologiques\ndirection_vent:'',force_vent:'',etat_mer:'',nebulosite:'',maree:'',// Contacts et alertes\ncedre_alerte:false,cross_alerte:false,photo:false,message_polrep:false,derive_mothy:false,polmar_terre:false,smp:false,bsaa:false,sensible_proximite:false,moyen_proximite:'',risque_court_terme:'',risque_moyen_long_terme:'',moyen_marine_etat:'',moyen_depeche:'',delai_appareillage:''};});// √âtats pour les listes d√©roulantes\nconst[typesEvenement,setTypesEvenement]=useState([]);const[sousTypesEvenement,setSousTypesEvenement]=useState([]);const[originesEvenement,setOriginesEvenement]=useState([]);// const [typesCible, setTypesCible] = useState([]); // SUPPRIM√â car inutilis√©\nconst[zonesGeographiques,setZonesGeographiques]=useState([]);const[filteredSousTypes,setFilteredSousTypes]=useState([]);// R√©cup√©ration des donn√©es pour les listes d√©roulantes\nuseEffect(()=>{const fetchOptionsData=async()=>{try{const[typesRes,sousTypesRes,originesRes,zonesRes/*, typesCibleRes*/]=await Promise.all([axios.get(`${API}/rapports/type-evenement`),axios.get(`${API}/rapports/sous-type-pollution`),axios.get(`${API}/rapports/origine-evenement`),axios.get(`${API}/rapports/zone-geographique`)// axios.get(`${API}/rapports/type-cible`) // SUPPRIM√â car inutilis√©\n]);setTypesEvenement(typesRes.data);setSousTypesEvenement(sousTypesRes.data);setOriginesEvenement(originesRes.data);setZonesGeographiques(zonesRes.data);// setTypesCible(typesCibleRes.data); // SUPPRIM√â car inutilis√©\n}catch(error){console.error('Erreur lors de la r√©cup√©ration des donn√©es:',error);}};fetchOptionsData();},[]);// Initialisation de la carte Leaflet\nuseEffect(()=>{// S'assurer que la carte est initialis√©e une seule fois et correctement\nif(mapRef.current&&!mapInitialized&&typeof window!=='undefined'){// S'assurer que Leaflet est disponible\nif(!window.L){const script=document.createElement('script');script.src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';script.integrity='sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=';script.crossOrigin='';// Ajouter la feuille de style Leaflet si elle n'est pas d√©j√† pr√©sente\nif(!document.querySelector('link[href*=\"leaflet.css\"]')){const link=document.createElement('link');link.rel='stylesheet';link.href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';link.integrity='sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=';link.crossOrigin='';document.head.appendChild(link);}script.onload=initMap;document.head.appendChild(script);}else{initMap();}}function initMap(){try{console.log(\"üó∫Ô∏è Initialisation de la carte...\");// Nettoyer la carte pr√©c√©dente si elle existe\nif(leafletMapRef.current){leafletMapRef.current.remove();}// Centre par d√©faut - \nconst defaultCenter=[48.3904,-4.4861];// Cr√©er la nouvelle carte\nleafletMapRef.current=window.L.map(mapRef.current).setView(defaultCenter,10);// Ajouter la couche de tuiles OpenStreetMap\nwindow.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'}).addTo(leafletMapRef.current);// Ajouter un gestionnaire de clic sur la carte\nleafletMapRef.current.on('click',function(e){const{lat,lng}=e.latlng;// Mettre √† jour les champs de latitude et longitude dans le formulaire\nsetFormData(prev=>({...prev,latitude:lat.toFixed(6),longitude:lng.toFixed(6)}));// Mettre √† jour ou cr√©er le marqueur\nif(marker){marker.setLatLng([lat,lng]);}else{const newMarker=window.L.marker([lat,lng]).addTo(leafletMapRef.current);setMarker(newMarker);}console.log(`Position s√©lectionn√©e: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);});// Force la mise √† jour de la carte apr√®s l'initialisation\nsetTimeout(()=>{if(leafletMapRef.current){leafletMapRef.current.invalidateSize();}},200);setMapInitialized(true);console.log(\"‚úÖ Carte initialis√©e avec succ√®s\");}catch(error){console.error('Erreur lors de l\\'initialisation de la carte:',error);}}// Nettoyer la carte au d√©montage du composant\nreturn()=>{if(leafletMapRef.current){leafletMapRef.current.remove();leafletMapRef.current=null;}};},[]);// Mettre √† jour la carte si les coordonn√©es sont modifi√©es manuellement\nuseEffect(()=>{if(mapInitialized&&leafletMapRef.current&&formData.latitude&&formData.longitude){const lat=parseFloat(formData.latitude);const lng=parseFloat(formData.longitude);if(!isNaN(lat)&&!isNaN(lng)){// Centrer la carte sur les coordonn√©es saisies manuellement\nleafletMapRef.current.setView([lat,lng],12);// Mettre √† jour ou cr√©er le marqueur\nif(marker){marker.setLatLng([lat,lng]);}else{const newMarker=window.L.marker([lat,lng]).addTo(leafletMapRef.current);setMarker(newMarker);}}}},[formData.latitude,formData.longitude,mapInitialized,marker]);// Filtrer les sous-types en fonction du type s√©lectionn√©\nuseEffect(()=>{if(formData.id_type_evenement){const filtered=sousTypesEvenement.filter(sousType=>sousType.id_type_evenement===parseInt(formData.id_type_evenement));setFilteredSousTypes(filtered);// R√©initialiser le sous-type s√©lectionn√© si le type change\nif(!filtered.find(st=>st.id_sous_type_evenement===parseInt(formData.id_sous_type_evenement))){setFormData(prev=>({...prev,id_sous_type_evenement:''}));}}else{setFilteredSousTypes([]);setFormData(prev=>({...prev,id_sous_type_evenement:''}));}},[formData.id_type_evenement,sousTypesEvenement]);// Afficher le champ de d√©lai d'appareillage seulement si BSAA est coch√©\nconst showDelaiAppareillage=formData.bsaa;// G√©rer les changements dans le formulaire\nconst handleChange=e=>{const{name,value,type,checked}=e.target;// Pour les checkboxes, utiliser la valeur de \"checked\" au lieu de \"value\"\nconst newValue=type==='checkbox'?checked:value;setFormData(prev=>({...prev,[name]:newValue}));};// Valider le formulaire avant soumission\nconst validateForm=()=>{// V√©rifier les champs obligatoires\nif(!formData.titre||!formData.date_evenement||!formData.heure_evenement||!formData.id_type_evenement||!formData.description_globale||!formData.id_zone){setSubmitStatus({type:'error',message:'Veuillez remplir tous les champs obligatoires (marqu√©s par *).'});return false;}return true;};// Fonction pour g√©rer l'envoi du formulaire\nconst handleSubmit=async e=>{e.preventDefault();// Valider le formulaire\nif(!validateForm()){return;}setIsSubmitting(true);setSubmitStatus(null);try{// Combiner la date et l'heure pour le backend\nconst dateTimeString=`${formData.date_evenement}T${formData.heure_evenement}:00`;// Cr√©er une date locale\nconst localDate=new Date(`${formData.date_evenement}T${formData.heure_evenement}:00`);// Convertir en UTC et formatter au format ISO\nconst dateTimeUTC=new Date(localDate.getTime()-localDate.getTimezoneOffset()*60000).toISOString();const rapport={titre:formData.titre,date_evenement:dateTimeUTC,description_globale:formData.description_globale,id_operateur:authData.Opid,id_type_evenement:formData.id_type_evenement?parseInt(formData.id_type_evenement):null,id_sous_type_evenement:formData.id_sous_type_evenement?parseInt(formData.id_sous_type_evenement):null,id_origine_evenement:formData.id_origine_evenement?parseInt(formData.id_origine_evenement):null};// Donn√©es associ√©es pour les tables connexes\nconst metaData={cible:{libelle:formData.libelle||null,nom_cible:formData.nom_cible||null,pavillon_cible:formData.pavillon_cible||null,immatriculation:formData.immatriculation||null,QuantiteProduit:formData.QuantiteProduit||null,TypeProduit:formData.TypeProduit||null},localisation:{id_zone:formData.id_zone?parseInt(formData.id_zone):null,details_lieu:formData.details_lieu||null,latitude:formData.latitude?parseFloat(formData.latitude):null,longitude:formData.longitude?parseFloat(formData.longitude):null},meteo:{direction_vent:formData.direction_vent||null,force_vent:formData.force_vent?parseInt(formData.force_vent):null,etat_mer:formData.etat_mer?parseInt(formData.etat_mer):null,nebulosite:formData.nebulosite?parseInt(formData.nebulosite):null,maree:formData.maree||null},alertes:{cedre_alerte:formData.cedre_alerte?1:0,cross_alerte:formData.cross_alerte?1:0,photo:formData.photo?1:0,message_polrep:formData.message_polrep?1:0,derive_mothy:formData.derive_mothy?1:0,polmar_terre:formData.polmar_terre?1:0,smp:formData.smp?1:0,bsaa:formData.bsaa?1:0,sensible_proximite:formData.sensible_proximite?1:0,delai_appareillage:formData.delai_appareillage||null,moyen_proximite:formData.moyen_proximite||null,risque_court_terme:formData.risque_court_terme||null,risque_moyen_long_terme:formData.risque_moyen_long_terme||null,moyen_depeche:formData.moyen_depeche||null,moyen_marine_etat:formData.moyen_marine_etat||null}};console.log(\"Donn√©es envoy√©es au backend:\",{rapport,metaData});// Envoi des donn√©es au backend\nconst response=await axios.post(`${API}/rapports`,{rapport,metaData});console.log('Rapport cr√©√© avec succ√®s:',response.data);setSubmitStatus({type:'success',message:'Rapport enregistr√© avec succ√®s!'});// R√©initialisation du formulaire apr√®s succ√®s\nresetForm();}catch(error){var _error$response,_error$response$data;console.error('Erreur lors de la cr√©ation du rapport:',error);setSubmitStatus({type:'error',message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Une erreur est survenue lors de l\\'enregistrement du rapport.'});}finally{setIsSubmitting(false);// Effacer le message de statut apr√®s 5 secondes si c'est un succ√®s\nif((submitStatus===null||submitStatus===void 0?void 0:submitStatus.type)==='success'){setTimeout(()=>{setSubmitStatus(null);},5000);}}};// Fonction pour r√©initialiser le formulaire\nconst resetForm=()=>{setFormData({titre:'',date_evenement:new Date().toISOString().split('T')[0],heure_evenement:new Date().toISOString().split('T')[1].substring(0,5),description_globale:'',id_type_evenement:'',id_sous_type_evenement:'',id_origine_evenement:'',libelle:'',nom_cible:'',pavillon_cible:'',id_zone:'',details_lieu:'',latitude:'',longitude:'',direction_vent:'',force_vent:'',etat_mer:'',nebulosite:'',maree:'',cedre_alerte:false,cross_alerte:false,photo:false,message_polrep:false,derive_mothy:false,polmar_terre:false,smp:false,bsaa:false,sensible_proximite:false,moyen_proximite:'',risque_court_terme:'',risque_moyen_long_terme:'',moyen_marine_etat:'',moyen_depeche:'',delai_appareillage:'',immatriculation:'',QuantiteProduit:'',TypeProduit:''});// Supprimer le marqueur de la carte\nif(marker&&leafletMapRef.current){leafletMapRef.current.removeLayer(marker);setMarker(null);}// Recentrer la carte\nif(leafletMapRef.current){leafletMapRef.current.setView([48.3904,-4.4861],10);}};// Reste du code (rendu du formulaire)...\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"rapport-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rapport-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Nouveau Rapport d'\\xC9v\\xE9nement\"}),/*#__PURE__*/_jsx(\"p\",{className:\"rapport-subtitle\",style:{fontSize:'0.9em',fontStyle:'italic'},children:\"Compl\\xE9tez tous les champs obligatoires (*) pour soumettre un nouveau rapport\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"rapport-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(GeneralInfoSection,{formData:formData,handleChange:handleChange}),/*#__PURE__*/_jsx(ClassificationSection,{formData:formData,handleChange:handleChange,typesEvenement:typesEvenement,filteredSousTypes:filteredSousTypes,originesEvenement:originesEvenement}),/*#__PURE__*/_jsx(TargetSection,{formData:formData,handleChange:handleChange}),/*#__PURE__*/_jsx(LocalisationSection,{formData:formData,handleChange:handleChange,mapRef:mapRef,mapInitialized:mapInitialized,zonesGeographiques:zonesGeographiques}),/*#__PURE__*/_jsx(MeteoSection,{formData:formData,handleChange:handleChange}),/*#__PURE__*/_jsx(AlertesSection,{formData:formData,handleChange:handleChange}),/*#__PURE__*/_jsx(DescriptionSection,{formData:formData,handleChange:handleChange}),/*#__PURE__*/_jsx(FormActions,{isSubmitting:isSubmitting,handleSubmit:handleSubmit,resetForm:resetForm})]}),/*#__PURE__*/_jsx(\"br\",{}),submitStatus&&/*#__PURE__*/_jsx(\"div\",{className:`status-message ${submitStatus.type}`,children:submitStatus.message})]});};export default AjouterRapport;","map":{"version":3,"names":["useState","useEffect","useRef","useAuth","axios","GeneralInfoSection","ClassificationSection","TargetSection","LocalisationSection","MeteoSection","AlertesSection","DescriptionSection","FormActions","jsx","_jsx","jsxs","_jsxs","API","process","env","REACT_APP_API_URL","AjouterRapport","authData","isSubmitting","setIsSubmitting","submitStatus","setSubmitStatus","mapRef","leafletMapRef","mapInitialized","setMapInitialized","marker","setMarker","formData","setFormData","now","Date","formattedDate","toISOString","split","hours","String","getHours","padStart","minutes","getMinutes","formattedTime","titre","date_evenement","heure_evenement","description_globale","id_type_evenement","id_sous_type_evenement","id_origine_evenement","libelle","nom_cible","pavillon_cible","id_zone","details_lieu","latitude","longitude","direction_vent","force_vent","etat_mer","nebulosite","maree","cedre_alerte","cross_alerte","photo","message_polrep","derive_mothy","polmar_terre","smp","bsaa","sensible_proximite","moyen_proximite","risque_court_terme","risque_moyen_long_terme","moyen_marine_etat","moyen_depeche","delai_appareillage","typesEvenement","setTypesEvenement","sousTypesEvenement","setSousTypesEvenement","originesEvenement","setOriginesEvenement","zonesGeographiques","setZonesGeographiques","filteredSousTypes","setFilteredSousTypes","fetchOptionsData","typesRes","sousTypesRes","originesRes","zonesRes","Promise","all","get","data","error","console","current","window","L","script","document","createElement","src","integrity","crossOrigin","querySelector","link","rel","href","head","appendChild","onload","initMap","log","remove","defaultCenter","map","setView","tileLayer","attribution","addTo","on","e","lat","lng","latlng","prev","toFixed","setLatLng","newMarker","setTimeout","invalidateSize","parseFloat","isNaN","filtered","filter","sousType","parseInt","find","st","showDelaiAppareillage","handleChange","name","value","type","checked","target","newValue","validateForm","message","handleSubmit","preventDefault","dateTimeString","localDate","dateTimeUTC","getTime","getTimezoneOffset","rapport","id_operateur","Opid","metaData","cible","immatriculation","QuantiteProduit","TypeProduit","localisation","meteo","alertes","response","post","resetForm","_error$response","_error$response$data","substring","removeLayer","className","children","style","fontSize","fontStyle","onSubmit"],"sources":["D:/Stage/MarineV3/frontend/src/components/pages/AjouterRapport.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport axios from 'axios';\r\nimport '../css/AjouterRapport.css';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n\r\nimport GeneralInfoSection from './AjouterRapport/GeneralInfoSection';\r\nimport ClassificationSection from './AjouterRapport/ClassificationSection';\r\nimport TargetSection from './AjouterRapport/TargetSection';\r\nimport LocalisationSection from './AjouterRapport/LocalisationSection';\r\nimport MeteoSection from './AjouterRapport/MeteoSection';\r\nimport AlertesSection from './AjouterRapport/AlertesSection';\r\nimport DescriptionSection from './AjouterRapport/DescriptionSection';\r\nimport FormActions from './AjouterRapport/FormActions';\r\n\r\n\r\nconst API = process.env.REACT_APP_API_URL;\r\n\r\nconst AjouterRapport = () => {\r\n  const { authData } = useAuth();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [submitStatus, setSubmitStatus] = useState(null);\r\n  const mapRef = useRef(null);\r\n  const leafletMapRef = useRef(null);\r\n  const [mapInitialized, setMapInitialized] = useState(false);\r\n  const [marker, setMarker] = useState(null);\r\n\r\n  const [formData, setFormData] = useState(() => {\r\n    // Get current date and time in local timezone\r\n    const now = new Date();\r\n\r\n    // Format date as YYYY-MM-DD for the date input\r\n    const formattedDate = now.toISOString().split('T')[0];\r\n\r\n    // Format time as HH:MM in local timezone for the time input\r\n    const hours = String(now.getHours()).padStart(2, '0');\r\n    const minutes = String(now.getMinutes()).padStart(2, '0');\r\n    const formattedTime = `${hours}:${minutes}`;\r\n\r\n    return {\r\n      titre: '',\r\n      date_evenement: formattedDate,\r\n      heure_evenement: formattedTime,\r\n      description_globale: '',\r\n      id_type_evenement: '',\r\n      id_sous_type_evenement: '',\r\n      id_origine_evenement: '',\r\n      // Champs pour la cible de l'√©v√©nement\r\n      libelle: '',\r\n      nom_cible: '',\r\n      pavillon_cible: '',\r\n      // Champs pour la localisation\r\n      id_zone: '',\r\n      details_lieu: '',\r\n      latitude: '',\r\n      longitude: '',\r\n      // Conditions m√©t√©orologiques\r\n      direction_vent: '',\r\n      force_vent: '',\r\n      etat_mer: '',\r\n      nebulosite: '',\r\n      maree: '',\r\n      // Contacts et alertes\r\n      cedre_alerte: false,\r\n      cross_alerte: false,\r\n      photo: false,\r\n      message_polrep: false,\r\n      derive_mothy: false,\r\n      polmar_terre: false,\r\n      smp: false,\r\n      bsaa: false,\r\n      sensible_proximite: false,\r\n      moyen_proximite: '',\r\n      risque_court_terme: '',\r\n      risque_moyen_long_terme: '',\r\n      moyen_marine_etat: '',\r\n      moyen_depeche: '',\r\n      delai_appareillage: ''\r\n    };\r\n  });\r\n\r\n  // √âtats pour les listes d√©roulantes\r\n  const [typesEvenement, setTypesEvenement] = useState([]);\r\n  const [sousTypesEvenement, setSousTypesEvenement] = useState([]);\r\n  const [originesEvenement, setOriginesEvenement] = useState([]);\r\n  // const [typesCible, setTypesCible] = useState([]); // SUPPRIM√â car inutilis√©\r\n  const [zonesGeographiques, setZonesGeographiques] = useState([]);\r\n  const [filteredSousTypes, setFilteredSousTypes] = useState([]);\r\n\r\n  // R√©cup√©ration des donn√©es pour les listes d√©roulantes\r\n  useEffect(() => {\r\n    const fetchOptionsData = async () => {\r\n      try {\r\n        const [typesRes, sousTypesRes, originesRes, zonesRes/*, typesCibleRes*/] = await Promise.all([\r\n          axios.get(`${API}/rapports/type-evenement`),\r\n          axios.get(`${API}/rapports/sous-type-pollution`),\r\n          axios.get(`${API}/rapports/origine-evenement`),\r\n          axios.get(`${API}/rapports/zone-geographique`)\r\n          // axios.get(`${API}/rapports/type-cible`) // SUPPRIM√â car inutilis√©\r\n        ]);\r\n\r\n        setTypesEvenement(typesRes.data);\r\n        setSousTypesEvenement(sousTypesRes.data);\r\n        setOriginesEvenement(originesRes.data);\r\n        setZonesGeographiques(zonesRes.data);\r\n        // setTypesCible(typesCibleRes.data); // SUPPRIM√â car inutilis√©\r\n      } catch (error) {\r\n        console.error('Erreur lors de la r√©cup√©ration des donn√©es:', error);\r\n      }\r\n    };\r\n\r\n    fetchOptionsData();\r\n  }, []);\r\n\r\n  // Initialisation de la carte Leaflet\r\n  useEffect(() => {\r\n    // S'assurer que la carte est initialis√©e une seule fois et correctement\r\n    if (mapRef.current && !mapInitialized && typeof window !== 'undefined') {\r\n      // S'assurer que Leaflet est disponible\r\n      if (!window.L) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\r\n        script.integrity = 'sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=';\r\n        script.crossOrigin = '';\r\n\r\n        // Ajouter la feuille de style Leaflet si elle n'est pas d√©j√† pr√©sente\r\n        if (!document.querySelector('link[href*=\"leaflet.css\"]')) {\r\n          const link = document.createElement('link');\r\n          link.rel = 'stylesheet';\r\n          link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\r\n          link.integrity = 'sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=';\r\n          link.crossOrigin = '';\r\n          document.head.appendChild(link);\r\n        }\r\n\r\n        script.onload = initMap;\r\n        document.head.appendChild(script);\r\n      } else {\r\n        initMap();\r\n      }\r\n    }\r\n\r\n    function initMap() {\r\n      try {\r\n        console.log(\"üó∫Ô∏è Initialisation de la carte...\");\r\n\r\n        // Nettoyer la carte pr√©c√©dente si elle existe\r\n        if (leafletMapRef.current) {\r\n          leafletMapRef.current.remove();\r\n        }\r\n\r\n        // Centre par d√©faut - \r\n        const defaultCenter = [48.3904, -4.4861];\r\n\r\n        // Cr√©er la nouvelle carte\r\n        leafletMapRef.current = window.L.map(mapRef.current).setView(defaultCenter, 10);\r\n\r\n        // Ajouter la couche de tuiles OpenStreetMap\r\n        window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n        }).addTo(leafletMapRef.current);\r\n\r\n        // Ajouter un gestionnaire de clic sur la carte\r\n        leafletMapRef.current.on('click', function (e) {\r\n          const { lat, lng } = e.latlng;\r\n\r\n          // Mettre √† jour les champs de latitude et longitude dans le formulaire\r\n          setFormData(prev => ({\r\n            ...prev,\r\n            latitude: lat.toFixed(6),\r\n            longitude: lng.toFixed(6)\r\n          }));\r\n\r\n          // Mettre √† jour ou cr√©er le marqueur\r\n          if (marker) {\r\n            marker.setLatLng([lat, lng]);\r\n          } else {\r\n            const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\r\n            setMarker(newMarker);\r\n          }\r\n\r\n          console.log(`Position s√©lectionn√©e: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\r\n        });\r\n\r\n        // Force la mise √† jour de la carte apr√®s l'initialisation\r\n        setTimeout(() => {\r\n          if (leafletMapRef.current) {\r\n            leafletMapRef.current.invalidateSize();\r\n          }\r\n        }, 200);\r\n\r\n        setMapInitialized(true);\r\n        console.log(\"‚úÖ Carte initialis√©e avec succ√®s\");\r\n      } catch (error) {\r\n        console.error('Erreur lors de l\\'initialisation de la carte:', error);\r\n      }\r\n    }\r\n\r\n    // Nettoyer la carte au d√©montage du composant\r\n    return () => {\r\n      if (leafletMapRef.current) {\r\n        leafletMapRef.current.remove();\r\n        leafletMapRef.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Mettre √† jour la carte si les coordonn√©es sont modifi√©es manuellement\r\n  useEffect(() => {\r\n    if (mapInitialized && leafletMapRef.current && formData.latitude && formData.longitude) {\r\n      const lat = parseFloat(formData.latitude);\r\n      const lng = parseFloat(formData.longitude);\r\n\r\n      if (!isNaN(lat) && !isNaN(lng)) {\r\n        // Centrer la carte sur les coordonn√©es saisies manuellement\r\n        leafletMapRef.current.setView([lat, lng], 12);\r\n\r\n        // Mettre √† jour ou cr√©er le marqueur\r\n        if (marker) {\r\n          marker.setLatLng([lat, lng]);\r\n        } else {\r\n          const newMarker = window.L.marker([lat, lng]).addTo(leafletMapRef.current);\r\n          setMarker(newMarker);\r\n        }\r\n      }\r\n    }\r\n  }, [formData.latitude, formData.longitude, mapInitialized, marker]);\r\n\r\n  // Filtrer les sous-types en fonction du type s√©lectionn√©\r\n  useEffect(() => {\r\n    if (formData.id_type_evenement) {\r\n      const filtered = sousTypesEvenement.filter(\r\n        sousType => sousType.id_type_evenement === parseInt(formData.id_type_evenement)\r\n      );\r\n      setFilteredSousTypes(filtered);\r\n      // R√©initialiser le sous-type s√©lectionn√© si le type change\r\n      if (!filtered.find(st => st.id_sous_type_evenement === parseInt(formData.id_sous_type_evenement))) {\r\n        setFormData(prev => ({ ...prev, id_sous_type_evenement: '' }));\r\n      }\r\n    } else {\r\n      setFilteredSousTypes([]);\r\n      setFormData(prev => ({ ...prev, id_sous_type_evenement: '' }));\r\n    }\r\n  }, [formData.id_type_evenement, sousTypesEvenement]);\r\n\r\n  // Afficher le champ de d√©lai d'appareillage seulement si BSAA est coch√©\r\n  const showDelaiAppareillage = formData.bsaa;\r\n\r\n  // G√©rer les changements dans le formulaire\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n\r\n    // Pour les checkboxes, utiliser la valeur de \"checked\" au lieu de \"value\"\r\n    const newValue = type === 'checkbox' ? checked : value;\r\n\r\n    setFormData(prev => ({ ...prev, [name]: newValue }));\r\n  };\r\n\r\n  // Valider le formulaire avant soumission\r\n  const validateForm = () => {\r\n    // V√©rifier les champs obligatoires\r\n    if (!formData.titre || !formData.date_evenement || !formData.heure_evenement ||\r\n      !formData.id_type_evenement || !formData.description_globale || !formData.id_zone) {\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: 'Veuillez remplir tous les champs obligatoires (marqu√©s par *).'\r\n      });\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  // Fonction pour g√©rer l'envoi du formulaire\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Valider le formulaire\r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setSubmitStatus(null);\r\n\r\n    try {\r\n      // Combiner la date et l'heure pour le backend\r\n      const dateTimeString = `${formData.date_evenement}T${formData.heure_evenement}:00`;\r\n\r\n      // Cr√©er une date locale\r\n      const localDate = new Date(`${formData.date_evenement}T${formData.heure_evenement}:00`);\r\n\r\n      // Convertir en UTC et formatter au format ISO\r\n      const dateTimeUTC = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString();\r\n\r\n\r\n\r\n\r\n\r\n      const rapport = {\r\n        titre: formData.titre,\r\n        date_evenement: dateTimeUTC,\r\n        description_globale: formData.description_globale,\r\n        id_operateur: authData.Opid,\r\n        id_type_evenement: formData.id_type_evenement ? parseInt(formData.id_type_evenement) : null,\r\n        id_sous_type_evenement: formData.id_sous_type_evenement ? parseInt(formData.id_sous_type_evenement) : null,\r\n        id_origine_evenement: formData.id_origine_evenement ? parseInt(formData.id_origine_evenement) : null,\r\n      };\r\n\r\n\r\n      // Donn√©es associ√©es pour les tables connexes\r\n      const metaData = {\r\n        cible: {\r\n          libelle: formData.libelle || null,\r\n          nom_cible: formData.nom_cible || null,\r\n          pavillon_cible: formData.pavillon_cible || null,\r\n          immatriculation: formData.immatriculation || null,\r\n          QuantiteProduit: formData.QuantiteProduit || null,\r\n          TypeProduit: formData.TypeProduit || null,\r\n        },\r\n        localisation: {\r\n          id_zone: formData.id_zone ? parseInt(formData.id_zone) : null,\r\n          details_lieu: formData.details_lieu || null,\r\n          latitude: formData.latitude ? parseFloat(formData.latitude) : null,\r\n          longitude: formData.longitude ? parseFloat(formData.longitude) : null,\r\n        },\r\n        meteo: {\r\n          direction_vent: formData.direction_vent || null,\r\n          force_vent: formData.force_vent ? parseInt(formData.force_vent) : null,\r\n          etat_mer: formData.etat_mer ? parseInt(formData.etat_mer) : null,\r\n          nebulosite: formData.nebulosite ? parseInt(formData.nebulosite) : null,\r\n          maree: formData.maree || null,\r\n        },\r\n        alertes: {\r\n          cedre_alerte: formData.cedre_alerte ? 1 : 0,\r\n          cross_alerte: formData.cross_alerte ? 1 : 0,\r\n          photo: formData.photo ? 1 : 0,\r\n          message_polrep: formData.message_polrep ? 1 : 0,\r\n          derive_mothy: formData.derive_mothy ? 1 : 0,\r\n          polmar_terre: formData.polmar_terre ? 1 : 0,\r\n          smp: formData.smp ? 1 : 0,\r\n          bsaa: formData.bsaa ? 1 : 0,\r\n          sensible_proximite: formData.sensible_proximite ? 1 : 0,\r\n          delai_appareillage: formData.delai_appareillage || null,\r\n          moyen_proximite: formData.moyen_proximite || null,\r\n          risque_court_terme: formData.risque_court_terme || null,\r\n          risque_moyen_long_terme: formData.risque_moyen_long_terme || null,\r\n          moyen_depeche: formData.moyen_depeche || null,\r\n          moyen_marine_etat: formData.moyen_marine_etat || null,\r\n        }\r\n      };\r\n\r\n      console.log(\"Donn√©es envoy√©es au backend:\", { rapport, metaData });\r\n\r\n      // Envoi des donn√©es au backend\r\n      const response = await axios.post(`${API}/rapports`, {\r\n        rapport,\r\n        metaData\r\n      });\r\n\r\n\r\n\r\n\r\n      console.log('Rapport cr√©√© avec succ√®s:', response.data);\r\n      setSubmitStatus({ type: 'success', message: 'Rapport enregistr√© avec succ√®s!' });\r\n\r\n      // R√©initialisation du formulaire apr√®s succ√®s\r\n      resetForm();\r\n    } catch (error) {\r\n      console.error('Erreur lors de la cr√©ation du rapport:', error);\r\n      setSubmitStatus({\r\n        type: 'error',\r\n        message: error.response?.data?.message || 'Une erreur est survenue lors de l\\'enregistrement du rapport.'\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n\r\n      // Effacer le message de statut apr√®s 5 secondes si c'est un succ√®s\r\n      if (submitStatus?.type === 'success') {\r\n        setTimeout(() => {\r\n          setSubmitStatus(null);\r\n        }, 5000);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Fonction pour r√©initialiser le formulaire\r\n  const resetForm = () => {\r\n    setFormData({\r\n      titre: '',\r\n      date_evenement: new Date().toISOString().split('T')[0],\r\n      heure_evenement: new Date().toISOString().split('T')[1].substring(0, 5),\r\n      description_globale: '',\r\n      id_type_evenement: '',\r\n      id_sous_type_evenement: '',\r\n      id_origine_evenement: '',\r\n      libelle: '',\r\n      nom_cible: '',\r\n      pavillon_cible: '',\r\n      id_zone: '',\r\n      details_lieu: '',\r\n      latitude: '',\r\n      longitude: '',\r\n      direction_vent: '',\r\n      force_vent: '',\r\n      etat_mer: '',\r\n      nebulosite: '',\r\n      maree: '',\r\n      cedre_alerte: false,\r\n      cross_alerte: false,\r\n      photo: false,\r\n      message_polrep: false,\r\n      derive_mothy: false,\r\n      polmar_terre: false,\r\n      smp: false,\r\n      bsaa: false,\r\n      sensible_proximite: false,\r\n      moyen_proximite: '',\r\n      risque_court_terme: '',\r\n      risque_moyen_long_terme: '',\r\n      moyen_marine_etat: '',\r\n      moyen_depeche: '',\r\n      delai_appareillage: '',\r\n      immatriculation: '',\r\n      QuantiteProduit: '',\r\n      TypeProduit: ''\r\n    });\r\n\r\n    // Supprimer le marqueur de la carte\r\n    if (marker && leafletMapRef.current) {\r\n      leafletMapRef.current.removeLayer(marker);\r\n      setMarker(null);\r\n    }\r\n\r\n    // Recentrer la carte\r\n    if (leafletMapRef.current) {\r\n      leafletMapRef.current.setView([48.3904, -4.4861], 10);\r\n    }\r\n  };\r\n\r\n  // Reste du code (rendu du formulaire)...\r\n  return (\r\n    <div className=\"rapport-container\">\r\n\r\n\r\n      <div className=\"rapport-header\">\r\n        <h1 >Nouveau Rapport d'√âv√©nement</h1>\r\n        <p className=\"rapport-subtitle\" style={{ fontSize: '0.9em', fontStyle: 'italic' }}>\r\n          Compl√©tez tous les champs obligatoires (*) pour soumettre un nouveau rapport\r\n        </p>\r\n      </div>\r\n\r\n\r\n\r\n      <form className=\"rapport-form\" onSubmit={handleSubmit}>\r\n        <GeneralInfoSection formData={formData} handleChange={handleChange} />\r\n        <ClassificationSection\r\n          formData={formData}\r\n          handleChange={handleChange}\r\n          typesEvenement={typesEvenement}\r\n          filteredSousTypes={filteredSousTypes}\r\n          originesEvenement={originesEvenement}\r\n        />\r\n        <TargetSection formData={formData} handleChange={handleChange} />\r\n        <LocalisationSection\r\n          formData={formData}\r\n          handleChange={handleChange}\r\n          mapRef={mapRef}\r\n          mapInitialized={mapInitialized}\r\n          zonesGeographiques={zonesGeographiques}\r\n        />\r\n        <MeteoSection formData={formData} handleChange={handleChange} />\r\n        <AlertesSection formData={formData} handleChange={handleChange} />\r\n        <DescriptionSection formData={formData} handleChange={handleChange} />\r\n        <FormActions\r\n          isSubmitting={isSubmitting}\r\n          handleSubmit={handleSubmit}\r\n          resetForm={resetForm}\r\n        />\r\n      </form>\r\n      <br></br>\r\n      {submitStatus && (\r\n        <div className={`status-message ${submitStatus.type}`}>\r\n          {submitStatus.message}\r\n        </div>\r\n      )}\r\n    </div>\r\n\r\n  );\r\n};\r\n\r\nexport default AjouterRapport;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}